<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OMO G Interiors - Offer Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --brand: #7a1f1f;
      --brand-deep: #461111;
      --accent: #bf9446;
      --ink: #1f2937;
      --muted: #6b7280;
      --panel: #ffffff;
      --line: #e5e7eb;
      --bg: #f3efe8;
      --ok: #159d77;
      --danger: #dc2626;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Manrope', sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 85% 0%, rgba(191, 148, 70, 0.12), transparent 30%),
        radial-gradient(circle at 0% 100%, rgba(122, 31, 31, 0.12), transparent 25%),
        var(--bg);
      padding: 20px;
      line-height: 1.5;
    }

    .page { max-width: 1120px; margin: 0 auto; }

    .lang-toggle {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-bottom: 12px;
    }

    .lang-toggle button {
      border: 1px solid var(--line);
      border-radius: 999px;
      background: #fff;
      color: var(--ink);
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 700;
      font-size: 12px;
    }

    .lang-toggle button.active {
      background: var(--brand);
      color: #fff;
      border-color: var(--brand);
    }

    .sheet {
      background: var(--panel);
      border-radius: 20px;
      border: 1px solid #e9e9e9;
      box-shadow: 0 25px 60px rgba(31, 41, 55, 0.1);
      overflow: hidden;
    }

    .hero {
      padding: 18px 24px 24px;
      color: #fff;
      background:
        linear-gradient(120deg, rgba(255,255,255,0.08), transparent 35%),
        linear-gradient(135deg, #8f2020, #5f1111 70%, #450c0c);
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    .hero-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .hero-mark {
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.84);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 999px;
      padding: 6px 10px;
      white-space: nowrap;
    }

    .hero-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .logo-wrap { text-align: center; flex: 0 0 auto; }

    .logo {
      width: 92px;
      height: 92px;
      border-radius: 14px;
      object-fit: contain;
      background: #fff;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 8px;
    }

    .logo-input {
      margin-top: 8px;
      font-size: 11px;
      color: #fff;
      background: rgba(255,255,255,0.2);
      padding: 6px 8px;
      border-radius: 8px;
      display: inline-block;
      cursor: pointer;
    }

    .brand-main { flex: 1; min-width: 0; }

    .brand-main h1 {
      font-family: 'Playfair Display', serif;
      font-size: 45px;
      line-height: 1.2;
      margin-bottom: 4px;
      word-break: break-word;
    }

    .brand-main .sub { opacity: 0.9; font-weight: 500; margin-bottom: 8px; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
      background: rgba(191, 148, 70, 0.95);
      color: #fff;
    }

    .print-hidden { display: block; }

    body[dir="rtl"] .hero-top { flex-direction: row-reverse; }
    body[dir="rtl"] .hero-main { flex-direction: row-reverse; }
    body[dir="rtl"] .brand-main { text-align: right; }

    .content { padding: 22px; display: grid; gap: 16px; }

    .section {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 16px;
      background: #fff;
    }

    .section h2 {
      font-family: 'Playfair Display', serif;
      color: var(--brand);
      margin-bottom: 12px;
      font-size: 21px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section h2::before {
      content: '';
      width: 4px;
      height: 22px;
      border-radius: 4px;
      background: var(--accent);
    }

    .grid { display: grid; gap: 12px; grid-template-columns: repeat(2, minmax(0,1fr)); }
    .field label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 700;
      margin-bottom: 6px;
      display: block;
    }

    input, select, textarea {
      width: 100%;
      border: 1.5px solid var(--line);
      border-radius: 10px;
      font: inherit;
      font-size: 14px;
      padding: 10px 12px;
      background: #fff;
      transition: border-color .2s ease, box-shadow .2s ease;
    }

    textarea { min-height: 92px; resize: vertical; }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(122, 31, 31, 0.12);
    }

    .hint { font-size: 12px; color: var(--muted); margin-top: 6px; }

    .line-items { display: grid; gap: 10px; margin-bottom: 10px; }

    .line-item {
      display: grid;
      grid-template-columns: 2fr .7fr 1fr auto;
      gap: 8px;
      align-items: end;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      background: #fbfbfb;
    }

    .line-item .remove-item {
      width: 34px;
      height: 34px;
      border: none;
      border-radius: 8px;
      background: var(--danger);
      color: #fff;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
    }

    .add-item {
      border: none;
      border-radius: 10px;
      padding: 9px 14px;
      background: var(--accent);
      color: #fff;
      font-weight: 800;
      font-size: 13px;
      cursor: pointer;
    }

    .summary {
      margin-top: 12px;
      border-radius: 14px;
      padding: 14px;
      color: #fff;
      background: linear-gradient(135deg, #5b1414, #8c2727);
    }

    .summary-row { display: flex; justify-content: space-between; padding: 7px 0; gap: 10px; font-size: 14px; }

    .summary-row.total {
      font-weight: 800;
      font-size: 18px;
      margin-top: 8px;
      border-top: 1px solid rgba(255,255,255,0.35);
      padding-top: 10px;
    }

    .discount-wrap {
      margin-top: 7px;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      border-radius: 10px;
      background: rgba(255,255,255,0.12);
    }

    .discount-wrap input {
      max-width: 110px;
      background: rgba(255,255,255,0.16);
      color: #fff;
      border-color: rgba(255,255,255,0.3);
    }

    .portfolio-head {
      display: grid;
      gap: 8px;
      grid-template-columns: 1fr 1fr 1fr auto;
      margin-bottom: 10px;
    }

    .portfolio-add {
      border: none;
      border-radius: 10px;
      padding: 10px 14px;
      background: var(--brand);
      color: #fff;
      font-weight: 800;
      cursor: pointer;
      min-width: 120px;
    }

    .portfolio-upload {
      border: 1.5px dashed #d1d5db;
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      background: #fafafa;
      cursor: pointer;
      margin-bottom: 10px;
    }

    .portfolio-grid {
      display: grid;
      gap: 10px;
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    }

    .portfolio-item {
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
      position: relative;
    }

    .portfolio-item img { width: 100%; height: 120px; object-fit: cover; background: #f3f4f6; }
    .portfolio-body { padding: 10px; display: grid; gap: 6px; }
    .portfolio-title { font-size: 13px; font-weight: 700; color: var(--ink); word-break: break-word; }
    .portfolio-link { font-size: 12px; color: var(--brand); text-decoration: none; word-break: break-all; }

    .portfolio-remove {
      position: absolute;
      top: 6px;
      right: 6px;
      border: none;
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: rgba(220, 38, 38, 0.95);
      color: #fff;
      font-weight: 800;
      cursor: pointer;
    }

    .signature-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .signature-wrap {
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
      background: #fcfcfc;
    }

    .signature-pad {
      width: 100%;
      height: 170px;
      display: block;
      background: #fff;
      touch-action: none;
      cursor: crosshair;
      border-bottom: 1px solid var(--line);
    }

    .signature-actions { display: flex; gap: 8px; padding: 10px; flex-wrap: wrap; }

    .ghost-btn, .danger-btn {
      border: 1px solid var(--line);
      border-radius: 10px;
      background: #fff;
      color: var(--ink);
      padding: 8px 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 13px;
    }

    .danger-btn { border-color: rgba(220, 38, 38, 0.35); color: var(--danger); }

    .approval-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
      padding: 12px;
      border: 1px solid var(--line);
      border-radius: 10px;
      background: #fafafa;
      font-size: 14px;
    }

    .approval-row input { width: 18px; height: 18px; accent-color: var(--brand); flex: 0 0 auto; }

    .footer {
      border-top: 1px solid var(--line);
      padding-top: 14px;
      margin-top: 8px;
      display: grid;
      gap: 5px;
      font-size: 13px;
      color: var(--muted);
    }

    .footer strong { color: var(--ink); }
    .footer a { color: var(--brand); text-decoration: none; font-weight: 700; }

    .actions {
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
    }

    .action {
      border: none;
      border-radius: 12px;
      padding: 11px 16px;
      font-weight: 800;
      cursor: pointer;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .action.primary { background: var(--brand); color: #fff; }
    .action.secondary { background: var(--accent); color: #fff; }
    .action.success { background: var(--ok); color: #fff; }

    .hidden { display: none !important; }

    @media print {
      body { padding: 0; background: #fff; }
      .lang-toggle, .actions, .logo-input, #logoInput, #portfolioInput, .portfolio-upload, .portfolio-head, .add-item, .remove-item, .portfolio-remove, .signature-actions, .print-hidden {
        display: none !important;
      }
      .sheet { box-shadow: none; border: none; border-radius: 0; }
      .content { padding: 12px; }
      input, select, textarea {
        border: none !important;
        box-shadow: none !important;
        background: transparent !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-top: 2px !important;
        padding-bottom: 2px !important;
      }
    }

    @media (max-width: 860px) {
      .grid { grid-template-columns: 1fr; }
      .line-item { grid-template-columns: 1fr; }
      .portfolio-head { grid-template-columns: 1fr; }
      .signature-grid { grid-template-columns: 1fr; }
      .hero-top { flex-direction: column; align-items: flex-start; }
      .hero-main { flex-direction: column-reverse; text-align: center; }
      .brand-main h1 { font-size: 30px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="lang-toggle">
      <button id="btnEN" class="active" onclick="setLang('en')">EN</button>
      <button id="btnAR" onclick="setLang('ar')">AR</button>
    </div>

    <div class="sheet" id="proposal">
      <header class="hero">
        <div class="hero-top">
          <div class="hero-mark" data-i18n="headerMark">Interior Offer</div>
          <div class="hero-mark" data-i18n="headerCountry">QATAR</div>
        </div>
        <div class="hero-main">
          <div class="brand-main">
            <h1 id="brandTitle"></h1>
            <div class="sub" id="brandSub"></div>
            <span class="badge" id="badgeText"></span>
          </div>
          <div class="logo-wrap">
            <img id="logo" class="logo" src="https://omoginteriors.com/logo.png" alt="Company Logo">
            <label class="logo-input" for="logoInput" data-i18n="changeLogo">Change Logo</label>
            <input id="logoInput" type="file" accept="image/*" class="hidden" onchange="uploadLogo(event)">
          </div>
        </div>
      </header>

      <main class="content">
        <section class="section">
          <h2 data-i18n="companyProfile">Company Profile</h2>
          <div class="grid">
            <div class="field"><label data-i18n="companyName">Company Name</label><input id="companyName"></div>
            <div class="field"><label data-i18n="companyTag">Tagline</label><input id="companyTagline"></div>
            <div class="field"><label data-i18n="offerBadge">Offer Badge</label><input id="offerBadge"></div>
            <div class="field"><label data-i18n="offerRef">Offer Reference</label><input id="offerRef" placeholder="OFF-2026-001"></div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="clientInfo">Client Information</h2>
          <div class="grid">
            <div class="field"><label data-i18n="clientName">Client Name</label><input id="client" data-i18n-placeholder="clientNamePlaceholder" placeholder="Enter client name"></div>
            <div class="field"><label data-i18n="location">Location</label><input id="location" data-i18n-placeholder="locationPlaceholder" placeholder="Area, Doha"></div>
            <div class="field"><label data-i18n="phone">Phone Number</label><input id="phone" type="tel" placeholder="+974 XXXX XXXX"></div>
            <div class="field"><label data-i18n="offerDate">Offer Date</label><input id="date" type="date"></div>
            <div class="field"><label data-i18n="currency">Currency</label>
              <select id="currency" onchange="calculateTotal()">
                <option value="QAR">QAR</option>
                <option value="USD">USD</option>
                <option value="SAR">SAR</option>
                <option value="AED">AED</option>
              </select>
            </div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="serviceDetails">Service Details</h2>
          <div class="grid">
            <div class="field">
              <label data-i18n="serviceType">Service Type</label>
              <select id="serviceType" onchange="updateServiceScope()">
                <option value="" data-en="Select Service" data-ar="ÿßÿÆÿ™ÿ± ÿßŸÑÿÆÿØŸÖÿ©">Select Service</option>
                <option value="gypsum" data-en="Gypsum Ceiling Installation" data-ar="ÿ™ÿ±ŸÉŸäÿ® ÿ¨ÿ®ÿ≥ ÿßŸÑÿ£ÿ≥ŸÇŸÅ">Gypsum Ceiling Installation</option>
                <option value="painting" data-en="Painting & Decoration" data-ar="ÿØŸáÿßŸÜ ŸàÿØŸäŸÉŸàÿ±">Painting & Decoration</option>
                <option value="3dwall" data-en="3D Wall Panels" data-ar="ÿ£ŸÑŸàÿßÿ≠ ÿ¨ÿØÿ±ÿßŸÜ ÿ´ŸÑÿßÿ´Ÿäÿ© ÿßŸÑÿ£ÿ®ÿπÿßÿØ">3D Wall Panels</option>
                <option value="furniture" data-en="Custom Furniture" data-ar="ÿ£ÿ´ÿßÿ´ ÿ≠ÿ≥ÿ® ÿßŸÑÿ∑ŸÑÿ®">Custom Furniture</option>
                <option value="renovation" data-en="Full Renovation" data-ar="ÿ™ÿ¨ÿØŸäÿØ ŸÉÿßŸÖŸÑ">Full Renovation</option>
                <option value="turnkey" data-en="Turnkey Interior Project" data-ar="ŸÖÿ¥ÿ±Ÿàÿπ ÿØÿßÿÆŸÑŸä ŸÖÿ™ŸÉÿßŸÖŸÑ">Turnkey Interior Project</option>
                <option value="custom" data-en="Custom Service" data-ar="ÿÆÿØŸÖÿ© ŸÖÿÆÿµÿµÿ©">Custom Service</option>
              </select>
            </div>
            <div class="field">
              <label data-i18n="duration">Duration</label>
              <select id="duration">
                <option value="" data-en="Select duration" data-ar="ÿßÿÆÿ™ÿ± ÿßŸÑŸÖÿØÿ©">Select duration</option>
                <option data-en="1-2 days" data-ar="1-2 ŸäŸàŸÖ">1-2 days</option>
                <option data-en="3-5 days" data-ar="3-5 ÿ£ŸäÿßŸÖ">3-5 days</option>
                <option data-en="1 week" data-ar="ÿ£ÿ≥ÿ®Ÿàÿπ">1 week</option>
                <option data-en="2 weeks" data-ar="ÿ£ÿ≥ÿ®ŸàÿπÿßŸÜ">2 weeks</option>
                <option data-en="3-4 weeks" data-ar="3-4 ÿ£ÿ≥ÿßÿ®Ÿäÿπ">3-4 weeks</option>
                <option data-en="1-2 months" data-ar="1-2 ÿ¥Ÿáÿ±">1-2 months</option>
              </select>
            </div>
            <div class="field"><label data-i18n="startDate">Estimated Start Date</label><input id="startDate" type="date"></div>
            <div class="field"><label data-i18n="validityDays">Offer Validity (Days)</label><input id="validityDays" type="number" min="1" value="7"></div>
          </div>
          <div class="field" style="margin-top:10px;">
            <label data-i18n="scopeOfWork">Scope of Work</label>
            <textarea id="scope" data-i18n-placeholder="scopePlaceholder"></textarea>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="pricingBreakdown">Pricing Breakdown</h2>
          <div id="lineItems" class="line-items"></div>
          <button type="button" class="add-item" onclick="addLineItem()" data-i18n="addLineItem">+ Add Line Item</button>

          <div class="summary">
            <div class="summary-row"><span data-i18n="subtotal">Subtotal</span><span id="subtotalAmount">QAR 0.00</span></div>
            <div class="discount-wrap">
              <label style="font-size:12px;font-weight:800;color:#fff" data-i18n="discount">Discount (%)</label>
              <input id="discountPercent" type="number" min="0" max="100" placeholder="0" oninput="calculateTotal()">
              <span id="discountAmount">- QAR 0.00</span>
            </div>
            <div class="summary-row total"><span data-i18n="total">TOTAL</span><span id="totalAmount">QAR 0.00</span></div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="whyChoose">Why Choose Us</h2>
          <div class="field">
            <label data-i18n="highlights">Highlights (one per line)</label>
            <textarea id="highlights"></textarea>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="portfolio">Portfolio Links & Images</h2>
          <div class="portfolio-upload" onclick="document.getElementById('portfolioInput').click()">
            <div style="font-size:28px">üì∏</div>
            <div data-i18n="uploadPortfolio">Click to upload portfolio images</div>
          </div>
          <input id="portfolioInput" type="file" accept="image/*" multiple class="hidden" onchange="addPortfolioImages(event)">

          <div class="portfolio-head">
            <input id="portfolioTitleInput" type="text" data-i18n-placeholder="portfolioTitlePlaceholder" placeholder="Project title">
            <input id="portfolioLinkInput" type="url" data-i18n-placeholder="portfolioLinkPlaceholder" placeholder="https://your-portfolio-link.com/project">
            <input id="portfolioThumbInput" type="url" data-i18n-placeholder="portfolioThumbPlaceholder" placeholder="Optional thumbnail image URL">
            <button type="button" class="portfolio-add" onclick="addPortfolioLink()" data-i18n="addLink">Add Link</button>
          </div>
          <div id="portfolio" class="portfolio-grid"></div>
          <p class="hint" data-i18n="portfolioHint">You can add image uploads and external portfolio links together.</p>
        </section>

        <section class="section">
          <h2 data-i18n="terms">Terms & Conditions</h2>
          <div class="grid">
            <div class="field">
              <label data-i18n="paymentTerms">Payment Terms (one per line)</label>
              <textarea id="paymentTerms"></textarea>
            </div>
            <div class="field">
              <label data-i18n="warranty">Warranty</label>
              <textarea id="warranty"></textarea>
            </div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="digitalSignature">Digital Signature</h2>
          <div class="signature-grid">
            <div>
              <h3 style="font-size:15px;margin-bottom:8px;color:var(--brand);" data-i18n="clientSignature">Client Signature</h3>
              <div class="signature-wrap">
                <canvas id="signaturePadClient" class="signature-pad"></canvas>
                <div class="signature-actions">
                  <button type="button" class="ghost-btn" onclick="saveSignature('client')" data-i18n="saveSignature">Save Signature</button>
                  <button type="button" class="danger-btn" onclick="clearSignature('client')" data-i18n="clearSignature">Clear Signature</button>
                  <span id="signatureStatusClient" class="hint" data-i18n="signatureHint">Sign using mouse or touch, then click Save Signature.</span>
                </div>
              </div>
              <div class="grid" style="margin-top:10px;">
                <div class="field"><label data-i18n="clientSignName">Client Signer Name</label><input id="clientSignerName" placeholder="Client name"></div>
                <div class="field"><label data-i18n="clientSignTitle">Client Signer Title</label><input id="clientSignerTitle" placeholder="Owner / Representative"></div>
                <div class="field"><label data-i18n="signDate">Signature Date</label><input id="signatureDateClient" type="date"></div>
              </div>
            </div>

            <div>
              <h3 style="font-size:15px;margin-bottom:8px;color:var(--brand);" data-i18n="companySignature">Company Signature</h3>
              <div class="signature-wrap">
                <canvas id="signaturePadCompany" class="signature-pad"></canvas>
                <div class="signature-actions">
                  <button type="button" class="ghost-btn" onclick="saveSignature('company')" data-i18n="saveSignature">Save Signature</button>
                  <button type="button" class="danger-btn" onclick="clearSignature('company')" data-i18n="clearSignature">Clear Signature</button>
                  <span id="signatureStatusCompany" class="hint" data-i18n="signatureHint">Sign using mouse or touch, then click Save Signature.</span>
                </div>
              </div>
              <div class="grid" style="margin-top:10px;">
                <div class="field"><label data-i18n="companySignName">Company Signer Name</label><input id="companySignerName"></div>
                <div class="field"><label data-i18n="companySignTitle">Company Signer Title</label><input id="companySignerTitle" value="CEO"></div>
                <div class="field"><label data-i18n="signDate">Signature Date</label><input id="signatureDateCompany" type="date"></div>
              </div>
            </div>
          </div>

          <label class="approval-row">
            <input id="offerApproved" type="checkbox">
            <span data-i18n="approvalCheck">Client confirms and approves this offer and scope.</span>
          </label>
          <p class="hint print-hidden" data-i18n="autosaveHint">Changes are auto-saved in this browser.</p>
          <div style="margin-top:10px;" class="print-hidden">
            <button type="button" class="ghost-btn" onclick="clearSavedState()" data-i18n="clearSavedData">Clear Saved Data</button>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="contactFooter">Contact & Footer</h2>
          <div class="grid">
            <div class="field"><label data-i18n="phone">Phone</label><input id="companyPhone" value="+974 7102 1381"></div>
            <div class="field"><label data-i18n="email">Email</label><input id="companyEmail" value="info@omoginteriors.com"></div>
            <div class="field"><label data-i18n="website">Website</label><input id="companyWebsite" value="https://omoginteriors.com"></div>
            <div class="field"><label data-i18n="social">Instagram / TikTok</label><input id="companySocial" value="Instagram: @omogdecor | TikTok: @omog_decor"></div>
          </div>
          <div class="field" style="margin-top:10px;"><label data-i18n="address">Address</label><textarea id="companyAddress"></textarea></div>

          <div class="footer" id="footerPreview">
            <strong id="footerCompany">OMO G INTERIOR DECORATION</strong>
            <div><span>üìû </span><a id="footerPhoneLink" href="tel:+97471021381">+974 7102 1381</a></div>
            <div><span>üìß </span><a id="footerEmailLink" href="mailto:info@omoginteriors.com">info@omoginteriors.com</a></div>
            <div><span>üåê </span><a id="footerWebsiteLink" target="_blank" href="https://omoginteriors.com">omoginteriors.com</a></div>
            <div id="footerAddress"></div>
            <div id="footerSocial">CR No: 235664 | Instagram: @omogdecor | TikTok: @omog_decor</div>
          </div>
        </section>
      </main>
    </div>

    <div class="actions">
      <button class="action primary" onclick="window.print()"><span>üñ®Ô∏è</span><span data-i18n="exportPdf">Export PDF</span></button>
      <button class="action secondary" onclick="shareWhatsApp()"><span>üí¨</span><span data-i18n="shareWhatsApp">Share via WhatsApp</span></button>
      <button class="action success" onclick="copyToClipboard()"><span>üìã</span><span data-i18n="copySummary">Copy Summary</span></button>
    </div>
  </div>

  <script>
    const i18n = {
      en: {
        changeLogo: 'Change Logo',
        headerMark: 'Interior Offer',
        headerCountry: 'QATAR',
        companyProfile: 'Company Profile',
        companyName: 'Company Name',
        companyTag: 'Tagline',
        offerBadge: 'Offer Badge',
        clientInfo: 'Client Information',
        clientName: 'Client Name',
        clientNamePlaceholder: 'Enter client name',
        location: 'Location',
        locationPlaceholder: 'Area, Doha',
        phone: 'Phone Number',
        email: 'Email',
        website: 'Website',
        social: 'Instagram / TikTok',
        offerDate: 'Offer Date',
        offerRef: 'Offer Reference',
        currency: 'Currency',
        serviceDetails: 'Service Details',
        serviceType: 'Service Type',
        duration: 'Duration',
        startDate: 'Estimated Start Date',
        validityDays: 'Offer Validity (Days)',
        scopeOfWork: 'Scope of Work',
        scopePlaceholder: 'Describe work scope...',
        pricingBreakdown: 'Pricing Breakdown',
        addLineItem: '+ Add Line Item',
        subtotal: 'Subtotal',
        discount: 'Discount (%)',
        total: 'TOTAL',
        whyChoose: 'Why Choose Us',
        highlights: 'Highlights (one per line)',
        portfolio: 'Portfolio Links & Images',
        uploadPortfolio: 'Click to upload portfolio images',
        portfolioTitlePlaceholder: 'Project title',
        portfolioLinkPlaceholder: 'https://your-portfolio-link.com/project',
        portfolioThumbPlaceholder: 'Optional thumbnail image URL',
        addLink: 'Add Link',
        portfolioHint: 'You can add image uploads and external portfolio links together.',
        terms: 'Terms & Conditions',
        paymentTerms: 'Payment Terms (one per line)',
        warranty: 'Warranty',
        digitalSignature: 'Digital Signature',
        clientSignature: 'Client Signature',
        companySignature: 'Company Signature',
        saveSignature: 'Save Signature',
        clearSignature: 'Clear Signature',
        signatureHint: 'Sign using mouse or touch, then click Save Signature.',
        clientSignName: 'Client Signer Name',
        clientSignTitle: 'Client Signer Title',
        companySignName: 'Company Signer Name',
        companySignTitle: 'Company Signer Title',
        signDate: 'Signature Date',
        approvalCheck: 'Client confirms and approves this offer and scope.',
        autosaveHint: 'Changes are auto-saved in this browser.',
        clearSavedData: 'Clear Saved Data',
        contactFooter: 'Contact & Footer',
        address: 'Address',
        exportPdf: 'Export PDF',
        shareWhatsApp: 'Share via WhatsApp',
        copySummary: 'Copy Summary',
        itemDescription: 'Description',
        qty: 'Qty',
        price: 'Price',
        remove: 'Remove',
        signatureSaved: 'Signature saved.',
        signatureCleared: 'Signature cleared.',
        copied: 'Offer summary copied to clipboard.',
        openLink: 'Open link',
        imageUpload: 'Image upload',
        linkRequired: 'Please enter a portfolio link.',
        noSignature: 'No signature to save yet.',
        approved: 'Approved',
        pending: 'Pending'
      },
      ar: {
        changeLogo: 'ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ¥ÿπÿßÿ±',
        headerMark: 'ÿπÿ±ÿ∂ ÿØÿßÿÆŸÑŸä',
        headerCountry: 'ŸÇÿ∑ÿ±',
        companyProfile: 'ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ¥ÿ±ŸÉÿ©',
        companyName: 'ÿßÿ≥ŸÖ ÿßŸÑÿ¥ÿ±ŸÉÿ©',
        companyTag: 'ÿßŸÑŸàÿµŸÅ',
        offerBadge: 'ÿ¥ÿßÿ±ÿ© ÿßŸÑÿπÿ±ÿ∂',
        clientInfo: 'ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ',
        clientName: 'ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ',
        clientNamePlaceholder: 'ÿßŸÉÿ™ÿ® ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ',
        location: 'ÿßŸÑŸÖŸàŸÇÿπ',
        locationPlaceholder: 'ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©ÿå ÿßŸÑÿØŸàÿ≠ÿ©',
        phone: 'ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ',
        email: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',
        website: 'ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',
        social: 'ÿ•ŸÜÿ≥ÿ™ÿ∫ÿ±ÿßŸÖ / ÿ™ŸäŸÉ ÿ™ŸàŸÉ',
        offerDate: 'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿπÿ±ÿ∂',
        offerRef: 'ÿ±ŸÇŸÖ ÿßŸÑÿπÿ±ÿ∂',
        currency: 'ÿßŸÑÿπŸÖŸÑÿ©',
        serviceDetails: 'ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿÆÿØŸÖÿ©',
        serviceType: 'ŸÜŸàÿπ ÿßŸÑÿÆÿØŸÖÿ©',
        duration: 'ÿßŸÑŸÖÿØÿ©',
        startDate: 'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ®ÿØÿ° ÿßŸÑŸÖÿ™ŸàŸÇÿπ',
        validityDays: 'ÿµŸÑÿßÿ≠Ÿäÿ© ÿßŸÑÿπÿ±ÿ∂ (ÿ£ŸäÿßŸÖ)',
        scopeOfWork: 'ŸÜÿ∑ÿßŸÇ ÿßŸÑÿπŸÖŸÑ',
        scopePlaceholder: 'ÿµŸÅ ŸÜÿ∑ÿßŸÇ ÿßŸÑÿπŸÖŸÑ...',
        pricingBreakdown: 'ÿ™ŸÅÿµŸäŸÑ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±',
        addLineItem: '+ ÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿØ',
        subtotal: 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä',
        discount: 'ÿßŸÑÿÆÿµŸÖ (%)',
        total: 'ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä',
        whyChoose: 'ŸÑŸÖÿßÿ∞ÿß ÿ™ÿÆÿ™ÿßÿ±ŸÜÿß',
        highlights: 'ŸÜŸÇÿßÿ∑ ÿßŸÑŸÇŸàÿ© (ÿ≥ÿ∑ÿ± ŸÑŸÉŸÑ ŸÜŸÇÿ∑ÿ©)',
        portfolio: 'ŸÖÿπÿ±ÿ∂ ÿßŸÑÿ£ÿπŸÖÿßŸÑ (ÿ±Ÿàÿßÿ®ÿ∑ ŸàÿµŸàÿ±)',
        uploadPortfolio: 'ÿßÿ∂ÿ∫ÿ∑ ŸÑÿ±ŸÅÿπ ÿµŸàÿ± ÿßŸÑÿ£ÿπŸÖÿßŸÑ',
        portfolioTitlePlaceholder: 'ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ',
        portfolioLinkPlaceholder: 'https://your-portfolio-link.com/project',
        portfolioThumbPlaceholder: 'ÿ±ÿßÿ®ÿ∑ ÿµŸàÿ±ÿ© ŸÖÿµÿ∫ÿ±ÿ© ÿßÿÆÿ™Ÿäÿßÿ±Ÿä',
        addLink: 'ÿ•ÿ∂ÿßŸÅÿ© ÿ±ÿßÿ®ÿ∑',
        portfolioHint: 'ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ∂ÿßŸÅÿ© ÿµŸàÿ± Ÿàÿ±Ÿàÿßÿ®ÿ∑ ÿÆÿßÿ±ÿ¨Ÿäÿ© ŸÖÿπÿßŸã.',
        terms: 'ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ',
        paymentTerms: 'ÿ¥ÿ±Ÿàÿ∑ ÿßŸÑÿØŸÅÿπ (ÿ≥ÿ∑ÿ± ŸÑŸÉŸÑ ŸÜŸÇÿ∑ÿ©)',
        warranty: 'ÿßŸÑÿ∂ŸÖÿßŸÜ',
        digitalSignature: 'ÿßŸÑÿ™ŸàŸÇŸäÿπ ÿßŸÑÿ±ŸÇŸÖŸä',
        clientSignature: 'ÿ™ŸàŸÇŸäÿπ ÿßŸÑÿπŸÖŸäŸÑ',
        companySignature: 'ÿ™ŸàŸÇŸäÿπ ÿßŸÑÿ¥ÿ±ŸÉÿ©',
        saveSignature: 'ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸàŸÇŸäÿπ',
        clearSignature: 'ŸÖÿ≥ÿ≠ ÿßŸÑÿ™ŸàŸÇŸäÿπ',
        signatureHint: 'ŸàŸÇŸëÿπ ÿ®ÿßŸÑŸÖÿßŸàÿ≥ ÿ£Ÿà ÿßŸÑŸÑŸÖÿ≥ ÿ´ŸÖ ÿßÿ∂ÿ∫ÿ∑ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸàŸÇŸäÿπ.',
        clientSignName: 'ÿßÿ≥ŸÖ ŸÖŸÖÿ´ŸÑ ÿßŸÑÿπŸÖŸäŸÑ',
        clientSignTitle: 'ÿµŸÅÿ© ŸÖŸÖÿ´ŸÑ ÿßŸÑÿπŸÖŸäŸÑ',
        companySignName: 'ÿßÿ≥ŸÖ ŸÖŸÖÿ´ŸÑ ÿßŸÑÿ¥ÿ±ŸÉÿ©',
        companySignTitle: 'ÿµŸÅÿ© ŸÖŸÖÿ´ŸÑ ÿßŸÑÿ¥ÿ±ŸÉÿ©',
        signDate: 'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸàŸÇŸäÿπ',
        approvalCheck: 'Ÿäÿ§ŸÉÿØ ÿßŸÑÿπŸÖŸäŸÑ ÿßŸÑŸÖŸàÿßŸÅŸÇÿ© ÿπŸÑŸâ Ÿáÿ∞ÿß ÿßŸÑÿπÿ±ÿ∂ ŸàŸÜÿ∑ÿßŸÇ ÿßŸÑÿπŸÖŸÑ.',
        autosaveHint: 'Ÿäÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÅŸä Ÿáÿ∞ÿß ÿßŸÑŸÖÿ™ÿµŸÅÿ≠.',
        clearSavedData: 'ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ©',
        contactFooter: 'ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸàÿßŸÑÿ™ÿ∞ŸäŸäŸÑ',
        address: 'ÿßŸÑÿπŸÜŸàÿßŸÜ',
        exportPdf: 'ÿ™ÿµÿØŸäÿ± PDF',
        shareWhatsApp: 'ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ®',
        copySummary: 'ŸÜÿ≥ÿÆ ÿßŸÑŸÖŸÑÿÆÿµ',
        itemDescription: 'ÿßŸÑŸàÿµŸÅ',
        qty: 'ÿßŸÑŸÉŸÖŸäÿ©',
        price: 'ÿßŸÑÿ≥ÿπÿ±',
        remove: 'ÿ≠ÿ∞ŸÅ',
        signatureSaved: 'ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸàŸÇŸäÿπ.',
        signatureCleared: 'ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿßŸÑÿ™ŸàŸÇŸäÿπ.',
        copied: 'ÿ™ŸÖ ŸÜÿ≥ÿÆ ŸÖŸÑÿÆÿµ ÿßŸÑÿπÿ±ÿ∂.',
        openLink: 'ŸÅÿ™ÿ≠ ÿßŸÑÿ±ÿßÿ®ÿ∑',
        imageUpload: 'ÿµŸàÿ±ÿ© ŸÖÿ±ŸÅŸàÿπÿ©',
        linkRequired: 'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ.',
        noSignature: 'ŸÑÿß ŸäŸàÿ¨ÿØ ÿ™ŸàŸÇŸäÿπ ŸÑŸÑÿ≠ŸÅÿ∏.',
        approved: 'ŸÖŸàÿßŸÅŸÇ',
        pending: 'ŸÇŸäÿØ ÿßŸÑŸÖÿ±ÿßÿ¨ÿπÿ©'
      }
    };

    const defaults = {
      en: {
        companyName: 'OMO G INTERIOR DECORATION',
        companyTagline: 'Trading & Interior Design Specialists - Doha, Qatar',
        offerBadge: 'Fast Offer',
        highlights: 'Licensed & Registered in Qatar (CR: 235664)\n45+ Successfully Completed Projects\nProfessional Team with Years of Experience\nHigh-Quality Materials & Clean Finishing\nWarranty on All Work\nTransparent Pricing - No Hidden Costs',
        paymentTerms: '50% deposit required to start work\n50% balance due upon project completion\nPayments accepted via cash, bank transfer, or card',
        warranty: 'All work comes with a 1-year warranty covering workmanship defects.',
        address: 'Office 70, 2nd Floor Block E, Al Mirqab Mall, Doha',
        scope: '- Gypsum ceiling installation/repair\n- LED cove lighting provision (optional)\n- Smooth finishing and paint\n- Clean delivery and site cleanup'
      },
      ar: {
        companyName: 'ÿ£ŸàŸÖŸàÿ¨ ŸÑŸÑÿØŸäŸÉŸàÿ± ÿßŸÑÿØÿßÿÆŸÑŸä',
        companyTagline: 'ÿßŸÑÿ™ÿ¨ÿßÿ±ÿ© ŸàÿßŸÑÿ™ÿµŸÖŸäŸÖ ÿßŸÑÿØÿßÿÆŸÑŸä - ÿßŸÑÿØŸàÿ≠ÿ©ÿå ŸÇÿ∑ÿ±',
        offerBadge: 'ÿπÿ±ÿ∂ ÿ≥ÿ±Ÿäÿπ',
        highlights: 'ŸÖÿ±ÿÆÿµ ŸàŸÖÿ≥ÿ¨ŸÑ ŸÅŸä ŸÇÿ∑ÿ± (ÿßŸÑÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿä: 235664)\nÿ£ŸÉÿ´ÿ± ŸÖŸÜ 45 ŸÖÿ¥ÿ±ŸàÿπÿßŸã ŸÖŸÜÿ¨ÿ≤ÿßŸã ÿ®ŸÜÿ¨ÿßÿ≠\nŸÅÿ±ŸäŸÇ ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä ÿ®ÿÆÿ®ÿ±ÿ© ÿ∑ŸàŸäŸÑÿ©\nŸÖŸàÿßÿØ ÿπÿßŸÑŸäÿ© ÿßŸÑÿ¨ŸàÿØÿ© Ÿàÿ™ÿ¥ÿ∑Ÿäÿ® ŸÜÿ∏ŸäŸÅ\nÿ∂ŸÖÿßŸÜ ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿπŸÖÿßŸÑ\nÿ™ÿ≥ÿπŸäÿ± Ÿàÿßÿ∂ÿ≠ ÿØŸàŸÜ ÿ™ŸÉÿßŸÑŸäŸÅ ŸÖÿÆŸÅŸäÿ©',
        paymentTerms: '50Ÿ™ ÿØŸÅÿπÿ© ŸÖŸÇÿØŸÖÿ© ŸÑÿ®ÿØÿ° ÿßŸÑÿπŸÖŸÑ\n50Ÿ™ ÿπŸÜÿØ ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ\nÿßŸÑÿØŸÅÿπ ŸÜŸÇÿØÿßŸã ÿ£Ÿà ÿ™ÿ≠ŸàŸäŸÑ ÿ®ŸÜŸÉŸä ÿ£Ÿà ÿ®ÿ∑ÿßŸÇÿ©',
        warranty: 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ÿ™ÿ¥ŸÖŸÑ ÿ∂ŸÖÿßŸÜ ŸÑŸÖÿØÿ© ÿ≥ŸÜÿ© ÿ∂ÿØ ÿπŸäŸàÿ® ÿßŸÑÿ™ŸÜŸÅŸäÿ∞.',
        address: 'ŸÖŸÉÿ™ÿ® 70ÿå ÿßŸÑÿ∑ÿßÿ®ŸÇ ÿßŸÑÿ´ÿßŸÜŸäÿå ÿ®ŸÑŸàŸÉ Eÿå ÿßŸÑŸÖÿ±ŸÇÿßÿ® ŸÖŸàŸÑÿå ÿßŸÑÿØŸàÿ≠ÿ©',
        scope: '- ÿ™ÿ±ŸÉŸäÿ®/ÿ•ÿµŸÑÿßÿ≠ ÿ¨ÿ®ÿ≥ ÿßŸÑÿ£ÿ≥ŸÇŸÅ\n- ÿ™ŸàŸÅŸäÿ± ÿ•ÿ∂ÿßÿ°ÿ© ŸÖÿÆŸÅŸäÿ© LED (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)\n- ÿ™ÿ¥ÿ∑Ÿäÿ® ŸÜÿßÿπŸÖ ŸàÿØŸáÿßŸÜ\n- ÿ™ÿ≥ŸÑŸäŸÖ ŸÜÿ∏ŸäŸÅ ŸÖÿπ ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÖŸàŸÇÿπ'
      }
    };

    const serviceTemplates = {
      en: {
        gypsum: defaults.en.scope,
        painting: '- Wall preparation and filling\n- Premium quality paint application\n- Two coats minimum\n- Clean finishing and touch-ups',
        '3dwall': '- 3D wall panel installation\n- Surface preparation\n- Professional mounting\n- LED backlighting (optional)',
        furniture: '- Custom furniture design\n- Material selection consultation\n- Professional installation\n- Finishing touches',
        renovation: '- Space planning and design\n- Demolition and preparation\n- Installation of new elements\n- Finishing and handover',
        turnkey: '- Complete design concept\n- Material procurement\n- Full project execution\n- Furniture and accessories\n- Final handover'
      },
      ar: {
        gypsum: defaults.ar.scope,
        painting: '- ÿ™ÿ¨ŸáŸäÿ≤ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜ ŸàŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿπŸäŸàÿ®\n- ÿØŸáÿßŸÜ ÿ®ÿ¨ŸàÿØÿ© ÿπÿßŸÑŸäÿ©\n- ÿ∑ÿ®ŸÇÿ™ÿßŸÜ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ\n- ÿ™ÿ¥ÿ∑Ÿäÿ® ŸÜŸáÿßÿ¶Ÿä Ÿàÿ™ŸÜÿ∏ŸäŸÅ',
        '3dwall': '- ÿ™ÿ±ŸÉŸäÿ® ÿ£ŸÑŸàÿßÿ≠ ÿ¨ÿØÿßÿ±Ÿäÿ© ÿ´ŸÑÿßÿ´Ÿäÿ© ÿßŸÑÿ£ÿ®ÿπÿßÿØ\n- ÿ™ÿ¨ŸáŸäÿ≤ ÿßŸÑÿ≥ÿ∑ÿ≠\n- ÿ™ÿ´ÿ®Ÿäÿ™ ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä\n- ÿ•ÿ∂ÿßÿ°ÿ© ÿÆŸÑŸÅŸäÿ© LED (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)',
        furniture: '- ÿ™ÿµŸÖŸäŸÖ ÿ£ÿ´ÿßÿ´ ÿ≠ÿ≥ÿ® ÿßŸÑÿ∑ŸÑÿ®\n- ÿßÿ≥ÿ™ÿ¥ÿßÿ±ÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖŸàÿßÿØ\n- ÿ™ÿ±ŸÉŸäÿ® ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä\n- ÿßŸÑŸÑŸÖÿ≥ÿßÿ™ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©',
        renovation: '- ÿ™ÿÆÿ∑Ÿäÿ∑ Ÿàÿ™ÿµŸÖŸäŸÖ ÿßŸÑŸÖÿ≥ÿßÿ≠ÿ©\n- ÿ£ÿπŸÖÿßŸÑ ÿ•ÿ≤ÿßŸÑÿ© Ÿàÿ™ÿ¨ŸáŸäÿ≤\n- ÿ™ÿ±ŸÉŸäÿ® ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©\n- ÿßŸÑÿ™ÿ¥ÿ∑Ÿäÿ® ŸàÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ',
        turnkey: '- ŸÖŸÅŸáŸàŸÖ ÿ™ÿµŸÖŸäŸÖ ŸÖÿ™ŸÉÿßŸÖŸÑ\n- ÿ™Ÿàÿ±ŸäÿØ ÿßŸÑŸÖŸàÿßÿØ\n- ÿ™ŸÜŸÅŸäÿ∞ ŸÉÿßŸÖŸÑ ŸÑŸÑŸÖÿ¥ÿ±Ÿàÿπ\n- ÿ£ÿ´ÿßÿ´ ŸàÿßŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™\n- ÿ™ÿ≥ŸÑŸäŸÖ ŸÜŸáÿßÿ¶Ÿä'
      }
    };

    const STORAGE_KEY = 'omog_offer_generator_state_v4';
    const LANG_SCOPED_FIELDS = ['companyName', 'companyTagline', 'offerBadge', 'highlights', 'paymentTerms', 'warranty', 'companyAddress', 'scope'];
    let currentLang = 'en';
    let saveTimer = null;
    let isRestoringState = false;
    const langScoped = { en: {}, ar: {} };

    const portfolioItems = [];
    const signaturePads = {};

    function normalizePhone(phone) {
      return (phone || '').replace(/[^\d+]/g, '');
    }

    function getDefaultForField(lang, fieldId) {
      const mapKey = fieldId === 'companyAddress' ? 'address' : fieldId;
      if (fieldId === 'scope') {
        const serviceType = document.getElementById('serviceType').value;
        return serviceTemplates[lang][serviceType] || defaults[lang].scope;
      }
      return defaults[lang][mapKey] || '';
    }

    function captureScopedFields(lang) {
      LANG_SCOPED_FIELDS.forEach(fieldId => {
        const el = document.getElementById(fieldId);
        if (!el) return;
        const value = (el.value || '').trim();
        langScoped[lang][fieldId] = value || getDefaultForField(lang, fieldId);
      });
    }

    function applyScopedFields(lang) {
      LANG_SCOPED_FIELDS.forEach(fieldId => {
        const el = document.getElementById(fieldId);
        if (!el) return;
        const stored = langScoped[lang][fieldId];
        el.value = (stored && stored.length) ? stored : getDefaultForField(lang, fieldId);
      });
    }

    function translateUi() {
      const dict = i18n[currentLang];
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
      });

      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (dict[key]) el.placeholder = dict[key];
      });

      document.querySelectorAll('#serviceType option, #duration option').forEach(option => {
        const key = currentLang === 'ar' ? 'ar' : 'en';
        if (option.dataset[key]) option.textContent = option.dataset[key];
      });

      document.body.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = currentLang;
      document.getElementById('btnEN').classList.toggle('active', currentLang === 'en');
      document.getElementById('btnAR').classList.toggle('active', currentLang === 'ar');

      renderLineItemLabels();
      renderPortfolio();
      refreshTexts();
    }

    function setLang(lang) {
      if (lang === currentLang) return;
      captureScopedFields(currentLang);
      currentLang = lang;
      applyScopedFields(currentLang);
      translateUi();
      scheduleSaveState();
    }

    function refreshTexts() {
      const companyName = document.getElementById('companyName').value.trim();
      const companyTagline = document.getElementById('companyTagline').value.trim();
      const offerBadge = document.getElementById('offerBadge').value.trim();

      document.getElementById('brandTitle').textContent = companyName || '-';
      document.getElementById('brandSub').textContent = companyTagline || '-';
      document.getElementById('badgeText').textContent = offerBadge || '-';

      const phone = document.getElementById('companyPhone').value.trim();
      const email = document.getElementById('companyEmail').value.trim();
      const website = document.getElementById('companyWebsite').value.trim();
      const websiteLabel = website.replace(/^https?:\/\//, '') || website;

      document.getElementById('footerCompany').textContent = companyName || '-';
      const phoneLink = document.getElementById('footerPhoneLink');
      phoneLink.textContent = phone || '-';
      phoneLink.href = `tel:${normalizePhone(phone)}`;

      const emailLink = document.getElementById('footerEmailLink');
      emailLink.textContent = email || '-';
      emailLink.href = `mailto:${email}`;

      const websiteLink = document.getElementById('footerWebsiteLink');
      websiteLink.textContent = websiteLabel || '-';
      websiteLink.href = website || '#';

      document.getElementById('footerAddress').textContent = document.getElementById('companyAddress').value.trim() || '-';
      document.getElementById('footerSocial').textContent = `CR No: 235664 | ${document.getElementById('companySocial').value.trim() || '-'}`;

      const companySignerName = document.getElementById('companySignerName');
      if (companySignerName.dataset.auto === '1') {
        companySignerName.value = companyName || defaults[currentLang].companyName;
      }
    }

    function uploadLogo(event) {
      const file = event.target.files && event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = () => {
        document.getElementById('logo').src = reader.result;
        saveState();
      };
      reader.readAsDataURL(file);
    }

    function newLineItemRow() {
      const item = document.createElement('div');
      item.className = 'line-item';
      item.innerHTML = `
        <div class="field">
          <label class="li-label-desc">Description</label>
          <input type="text" class="item-desc" placeholder="Item description">
        </div>
        <div class="field">
          <label class="li-label-qty">Qty</label>
          <input type="number" class="item-qty" min="1" value="1" oninput="calculateTotal()">
        </div>
        <div class="field">
          <label class="li-label-price">Price</label>
          <input type="number" class="item-price" min="0" placeholder="0" oninput="calculateTotal()">
        </div>
        <button type="button" class="remove-item" onclick="removeItem(this)">√ó</button>
      `;
      return item;
    }

    function renderLineItemLabels() {
      const dict = i18n[currentLang];
      document.querySelectorAll('.li-label-desc').forEach(el => el.textContent = dict.itemDescription);
      document.querySelectorAll('.li-label-qty').forEach(el => el.textContent = dict.qty);
      document.querySelectorAll('.li-label-price').forEach(el => {
        el.textContent = `${dict.price} (${document.getElementById('currency').value})`;
      });
      document.querySelectorAll('.remove-item').forEach(btn => btn.title = dict.remove);
    }

    function addLineItem() {
      document.getElementById('lineItems').appendChild(newLineItemRow());
      renderLineItemLabels();
      calculateTotal();
    }

    function removeItem(button) {
      const parent = button.closest('.line-item');
      if (parent) parent.remove();
      calculateTotal();
      scheduleSaveState();
    }

    function calculateTotal() {
      const currency = document.getElementById('currency').value || 'QAR';
      let subtotal = 0;

      document.querySelectorAll('.line-item').forEach(item => {
        const qty = parseFloat(item.querySelector('.item-qty')?.value || '0') || 0;
        const price = parseFloat(item.querySelector('.item-price')?.value || '0') || 0;
        subtotal += qty * price;
      });

      const discountPercent = parseFloat(document.getElementById('discountPercent').value || '0') || 0;
      const discountAmount = subtotal * Math.max(0, Math.min(100, discountPercent)) / 100;
      const total = subtotal - discountAmount;

      document.getElementById('subtotalAmount').textContent = `${currency} ${subtotal.toFixed(2)}`;
      document.getElementById('discountAmount').textContent = `- ${currency} ${discountAmount.toFixed(2)}`;
      document.getElementById('totalAmount').textContent = `${currency} ${total.toFixed(2)}`;

      renderLineItemLabels();
      scheduleSaveState();
    }

    function updateServiceScope() {
      const serviceType = document.getElementById('serviceType').value;
      const template = serviceTemplates[currentLang][serviceType];
      if (template) {
        document.getElementById('scope').value = template;
      }
      captureScopedFields(currentLang);
      scheduleSaveState();
    }

    function addPortfolioImages(event) {
      const files = Array.from(event.target.files || []);
      files.forEach(file => {
        const reader = new FileReader();
        reader.onload = () => {
          portfolioItems.push({
            id: crypto.randomUUID(),
            type: 'image',
            title: file.name,
            href: '',
            thumb: reader.result
          });
          renderPortfolio();
          scheduleSaveState();
        };
        reader.readAsDataURL(file);
      });
      event.target.value = '';
    }

    function addPortfolioLink() {
      const title = document.getElementById('portfolioTitleInput').value.trim();
      const href = document.getElementById('portfolioLinkInput').value.trim();
      const thumb = document.getElementById('portfolioThumbInput').value.trim();

      if (!href) {
        alert(i18n[currentLang].linkRequired);
        return;
      }

      portfolioItems.push({
        id: crypto.randomUUID(),
        type: 'link',
        title: title || href,
        href,
        thumb: thumb || ''
      });

      document.getElementById('portfolioTitleInput').value = '';
      document.getElementById('portfolioLinkInput').value = '';
      document.getElementById('portfolioThumbInput').value = '';
      renderPortfolio();
      scheduleSaveState();
    }

    function removePortfolioItem(id) {
      const index = portfolioItems.findIndex(item => item.id === id);
      if (index !== -1) portfolioItems.splice(index, 1);
      renderPortfolio();
      scheduleSaveState();
    }

    function renderPortfolio() {
      const dict = i18n[currentLang];
      const container = document.getElementById('portfolio');
      container.innerHTML = '';

      portfolioItems.forEach(item => {
        const card = document.createElement('article');
        card.className = 'portfolio-item';

        const thumb = item.thumb
          ? `<img src="${item.thumb}" alt="${item.title || 'Portfolio'}">`
          : '<img src="https://dummyimage.com/400x240/f2f2f2/7a1f1f&text=Portfolio+Link" alt="Portfolio link">';

        const safeTitle = item.title || (currentLang === 'ar' ? 'ÿ±ÿßÿ®ÿ∑ ŸÖÿ¥ÿ±Ÿàÿπ' : 'Project link');
        const body = item.href
          ? `<a class="portfolio-link" href="${item.href}" target="_blank" rel="noopener">${dict.openLink}</a>`
          : `<span class="hint">${dict.imageUpload}</span>`;

        card.innerHTML = `
          ${thumb}
          <button type="button" class="portfolio-remove" onclick="removePortfolioItem('${item.id}')">√ó</button>
          <div class="portfolio-body">
            <div class="portfolio-title">${safeTitle}</div>
            ${body}
          </div>
        `;
        container.appendChild(card);
      });
    }

    function setupSignaturePad(name, canvasId, statusId) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      signaturePads[name] = { canvas, ctx, statusId, drawing: false, hasInk: false, savedData: '' };

      const start = evt => {
        const pad = signaturePads[name];
        pad.drawing = true;
        const p = getCanvasPos(canvas, evt);
        pad.ctx.beginPath();
        pad.ctx.moveTo(p.x, p.y);
        evt.preventDefault();
      };

      const move = evt => {
        const pad = signaturePads[name];
        if (!pad.drawing) return;
        const p = getCanvasPos(canvas, evt);
        pad.ctx.lineTo(p.x, p.y);
        pad.ctx.stroke();
        pad.hasInk = true;
        evt.preventDefault();
      };

      const end = () => {
        const pad = signaturePads[name];
        pad.drawing = false;
        pad.ctx.closePath();
      };

      canvas.addEventListener('mousedown', start);
      canvas.addEventListener('mousemove', move);
      canvas.addEventListener('mouseup', end);
      canvas.addEventListener('mouseleave', end);
      canvas.addEventListener('touchstart', start, { passive: false });
      canvas.addEventListener('touchmove', move, { passive: false });
      canvas.addEventListener('touchend', end);

      resizeSignaturePad(name);
    }

    function getCanvasPos(canvas, evt) {
      const rect = canvas.getBoundingClientRect();
      const source = evt.touches ? evt.touches[0] : evt;
      return { x: source.clientX - rect.left, y: source.clientY - rect.top };
    }

    function resizeSignaturePad(name) {
      const pad = signaturePads[name];
      if (!pad) return;
      const hasSaved = !!pad.savedData;
      const ratio = Math.max(window.devicePixelRatio || 1, 1);
      const displayWidth = pad.canvas.clientWidth;
      const displayHeight = pad.canvas.clientHeight;
      pad.canvas.width = Math.floor(displayWidth * ratio);
      pad.canvas.height = Math.floor(displayHeight * ratio);
      pad.ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
      pad.ctx.lineWidth = 2;
      pad.ctx.lineCap = 'round';
      pad.ctx.strokeStyle = '#111827';
      if (hasSaved) drawSignatureFromData(name, pad.savedData);
    }

    function resizeAllSignaturePads() {
      Object.keys(signaturePads).forEach(name => resizeSignaturePad(name));
    }

    function drawSignatureFromData(name, dataUrl) {
      const pad = signaturePads[name];
      if (!pad || !dataUrl) return;
      const img = new Image();
      img.onload = () => {
        pad.ctx.clearRect(0, 0, pad.canvas.width, pad.canvas.height);
        pad.ctx.drawImage(img, 0, 0, pad.canvas.clientWidth, pad.canvas.clientHeight);
        pad.hasInk = true;
      };
      img.src = dataUrl;
    }

    function clearSignature(name) {
      const pad = signaturePads[name];
      pad.ctx.clearRect(0, 0, pad.canvas.width, pad.canvas.height);
      pad.hasInk = false;
      pad.savedData = '';
      document.getElementById(pad.statusId).textContent = i18n[currentLang].signatureCleared;
      scheduleSaveState();
    }

    function saveSignature(name) {
      const pad = signaturePads[name];
      if (!pad.hasInk) {
        document.getElementById(pad.statusId).textContent = i18n[currentLang].noSignature;
        return;
      }
      pad.savedData = pad.canvas.toDataURL('image/png');
      document.getElementById(pad.statusId).textContent = i18n[currentLang].signatureSaved;
      saveState();
    }

    function collectLineItems() {
      return Array.from(document.querySelectorAll('.line-item')).map(row => ({
        desc: row.querySelector('.item-desc')?.value || '',
        qty: row.querySelector('.item-qty')?.value || '1',
        price: row.querySelector('.item-price')?.value || ''
      }));
    }

    function restoreLineItems(items) {
      const container = document.getElementById('lineItems');
      container.innerHTML = '';
      if (!items || !items.length) {
        addLineItem();
        return;
      }
      items.forEach(entry => {
        const row = newLineItemRow();
        row.querySelector('.item-desc').value = entry.desc || '';
        row.querySelector('.item-qty').value = entry.qty || '1';
        row.querySelector('.item-price').value = entry.price || '';
        container.appendChild(row);
      });
      renderLineItemLabels();
      calculateTotal();
    }

    function scheduleSaveState() {
      if (isRestoringState) return;
      clearTimeout(saveTimer);
      saveTimer = setTimeout(saveState, 180);
    }

    function saveState() {
      if (isRestoringState) return;
      const values = {};
      document.querySelectorAll('input[id], select[id], textarea[id]').forEach(el => {
        if (el.type === 'file') return;
        values[el.id] = el.type === 'checkbox' ? el.checked : el.value;
      });
      const state = {
        values,
        currentLang,
        langScoped,
        lineItems: collectLineItems(),
        portfolioItems,
        logoSrc: document.getElementById('logo').src || '',
        signatures: {
          client: signaturePads.client?.savedData || '',
          company: signaturePads.company?.savedData || ''
        },
        companySignerAuto: document.getElementById('companySignerName').dataset.auto || '0'
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function loadState() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return false;
      try {
        const state = JSON.parse(raw);
        isRestoringState = true;

        if (state.values && typeof state.values === 'object') {
          Object.entries(state.values).forEach(([id, value]) => {
            const el = document.getElementById(id);
            if (!el) return;
            if (el.type === 'checkbox') el.checked = !!value;
            else el.value = value;
          });
        }

        if (state.langScoped && typeof state.langScoped === 'object') {
          if (state.langScoped.en) langScoped.en = { ...langScoped.en, ...state.langScoped.en };
          if (state.langScoped.ar) langScoped.ar = { ...langScoped.ar, ...state.langScoped.ar };
        }

        restoreLineItems(state.lineItems);

        portfolioItems.length = 0;
        if (Array.isArray(state.portfolioItems)) {
          state.portfolioItems.forEach(item => portfolioItems.push(item));
        }

        if (state.logoSrc) {
          document.getElementById('logo').src = state.logoSrc;
        }

        if (state.signatures?.client) {
          signaturePads.client.savedData = state.signatures.client;
          drawSignatureFromData('client', state.signatures.client);
        }

        if (state.signatures?.company) {
          signaturePads.company.savedData = state.signatures.company;
          drawSignatureFromData('company', state.signatures.company);
        }

        if (state.companySignerAuto) {
          document.getElementById('companySignerName').dataset.auto = state.companySignerAuto;
        }

        currentLang = state.currentLang || 'en';
        applyScopedFields(currentLang);
        translateUi();
        return true;
      } catch (error) {
        console.error('Failed to load state', error);
        return false;
      } finally {
        isRestoringState = false;
      }
    }

    function clearSavedState() {
      localStorage.removeItem(STORAGE_KEY);
      window.location.reload();
    }

    function getPortfolioLinksForText() {
      return portfolioItems
        .filter(item => item.href)
        .map(item => `- ${item.title || item.href}: ${item.href}`)
        .join('\n');
    }

    function generateSummaryText() {
      const dict = i18n[currentLang];
      const client = document.getElementById('client').value.trim() || (currentLang === 'ar' ? 'ÿπŸÖŸäŸÑ' : 'Valued Customer');
      const service = document.getElementById('serviceType').selectedOptions[0]?.textContent || '-';
      const total = document.getElementById('totalAmount').textContent;
      const duration = document.getElementById('duration').value || '-';
      const startDate = document.getElementById('startDate').value || '-';
      const scope = document.getElementById('scope').value.trim();
      const ref = document.getElementById('offerRef').value.trim() || '-';
      const links = getPortfolioLinksForText();
      const approved = document.getElementById('offerApproved').checked;

      if (currentLang === 'ar') {
        return `ÿπÿ±ÿ∂ OMO G\n\n` +
          `ÿßŸÑÿπŸÖŸäŸÑ: ${client}\n` +
          `ÿ±ŸÇŸÖ ÿßŸÑÿπÿ±ÿ∂: ${ref}\n` +
          `ÿßŸÑÿÆÿØŸÖÿ©: ${service}\n` +
          `ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: ${total}\n` +
          `ÿßŸÑŸÖÿØÿ©: ${duration}\n` +
          `ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ®ÿØÿ°: ${startDate}\n\n` +
          `ŸÜÿ∑ÿßŸÇ ÿßŸÑÿπŸÖŸÑ:\n${scope}\n\n` +
          (links ? `ÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑÿ£ÿπŸÖÿßŸÑ:\n${links}\n\n` : '') +
          `ŸÖŸÖÿ´ŸÑ ÿßŸÑÿπŸÖŸäŸÑ: ${document.getElementById('clientSignerName').value.trim() || '-'}\n` +
          `ŸÖŸÖÿ´ŸÑ ÿßŸÑÿ¥ÿ±ŸÉÿ©: ${document.getElementById('companySignerName').value.trim() || '-'}\n` +
          `ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖŸàÿßŸÅŸÇÿ©: ${approved ? dict.approved : dict.pending}\n` +
          `ÿßŸÑŸáÿßÿ™ŸÅ: ${document.getElementById('companyPhone').value.trim()}\n` +
          `ÿßŸÑŸÖŸàŸÇÿπ: ${document.getElementById('companyWebsite').value.trim()}`;
      }

      return `OMO G Offer\n\n` +
        `Client: ${client}\n` +
        `Offer Ref: ${ref}\n` +
        `Service: ${service}\n` +
        `Total: ${total}\n` +
        `Duration: ${duration}\n` +
        `Start Date: ${startDate}\n\n` +
        `Scope:\n${scope}\n\n` +
        (links ? `Portfolio Links:\n${links}\n\n` : '') +
        `Client Signer: ${document.getElementById('clientSignerName').value.trim() || '-'}\n` +
        `Company Signer: ${document.getElementById('companySignerName').value.trim() || '-'}\n` +
        `Approval: ${approved ? dict.approved : dict.pending}\n` +
        `Phone: ${document.getElementById('companyPhone').value.trim()}\n` +
        `Website: ${document.getElementById('companyWebsite').value.trim()}`;
    }

    function shareWhatsApp() {
      window.open(`https://wa.me/?text=${encodeURIComponent(generateSummaryText())}`, '_blank');
    }

    function copyToClipboard() {
      navigator.clipboard.writeText(generateSummaryText()).then(() => {
        alert(i18n[currentLang].copied);
      });
    }

    function bindLiveUpdates() {
      const main = document.querySelector('main');
      main.addEventListener('input', () => {
        refreshTexts();
        captureScopedFields(currentLang);
        scheduleSaveState();
      });
      main.addEventListener('change', scheduleSaveState);

      const companySignerName = document.getElementById('companySignerName');
      companySignerName.addEventListener('input', () => {
        companySignerName.dataset.auto = '0';
      });
    }

    function applyInitialDefaults() {
      document.getElementById('companyName').value = defaults.en.companyName;
      document.getElementById('companyTagline').value = defaults.en.companyTagline;
      document.getElementById('offerBadge').value = defaults.en.offerBadge;
      document.getElementById('highlights').value = defaults.en.highlights;
      document.getElementById('paymentTerms').value = defaults.en.paymentTerms;
      document.getElementById('warranty').value = defaults.en.warranty;
      document.getElementById('companyAddress').value = defaults.en.address;
      document.getElementById('scope').value = defaults.en.scope;
      document.getElementById('companySignerName').value = defaults.en.companyName;
      document.getElementById('companySignerName').dataset.auto = '1';
      langScoped.en = {
        companyName: defaults.en.companyName,
        companyTagline: defaults.en.companyTagline,
        offerBadge: defaults.en.offerBadge,
        highlights: defaults.en.highlights,
        paymentTerms: defaults.en.paymentTerms,
        warranty: defaults.en.warranty,
        companyAddress: defaults.en.address,
        scope: defaults.en.scope
      };
      langScoped.ar = {
        companyName: defaults.ar.companyName,
        companyTagline: defaults.ar.companyTagline,
        offerBadge: defaults.ar.offerBadge,
        highlights: defaults.ar.highlights,
        paymentTerms: defaults.ar.paymentTerms,
        warranty: defaults.ar.warranty,
        companyAddress: defaults.ar.address,
        scope: defaults.ar.scope
      };
    }

    function init() {
      const now = new Date();
      document.getElementById('date').valueAsDate = now;
      document.getElementById('signatureDateClient').valueAsDate = now;
      document.getElementById('signatureDateCompany').valueAsDate = now;

      applyInitialDefaults();
      addLineItem();

      setupSignaturePad('client', 'signaturePadClient', 'signatureStatusClient');
      setupSignaturePad('company', 'signaturePadCompany', 'signatureStatusCompany');
      window.addEventListener('resize', resizeAllSignaturePads);

      const restored = loadState();
      if (!restored) {
        translateUi();
        calculateTotal();
      }

      bindLiveUpdates();
      refreshTexts();
      saveState();
    }

    init();
  </script>
</body>
</html>
