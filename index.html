<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OMO G Interiors - Offer Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --brand: #7a1f1f;
      --brand-deep: #461111;
      --accent: #bf9446;
      --ink: #1f2937;
      --muted: #6b7280;
      --panel: #ffffff;
      --line: #e5e7eb;
      --bg: #f3efe8;
      --ok: #159d77;
      --warn: #f59e0b;
      --danger: #dc2626;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Manrope', sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 85% 0%, rgba(191, 148, 70, 0.12), transparent 30%),
        radial-gradient(circle at 0% 100%, rgba(122, 31, 31, 0.12), transparent 25%),
        var(--bg);
      padding: 20px;
      line-height: 1.5;
    }

    .page {
      max-width: 1120px;
      margin: 0 auto;
    }

    .lang-toggle {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-bottom: 12px;
    }

    .lang-toggle button {
      border: 1px solid var(--line);
      border-radius: 999px;
      background: #fff;
      color: var(--ink);
      padding: 8px 14px;
      cursor: pointer;
      font-weight: 700;
      font-size: 12px;
    }

    .lang-toggle button.active {
      background: var(--brand);
      color: #fff;
      border-color: var(--brand);
    }

    .sheet {
      background: var(--panel);
      border-radius: 20px;
      border: 1px solid #e9e9e9;
      box-shadow: 0 25px 60px rgba(31, 41, 55, 0.1);
      overflow: hidden;
    }

    .hero {
      display: flex;
      gap: 18px;
      align-items: center;
      padding: 24px;
      color: #fff;
      background: linear-gradient(135deg, var(--brand), var(--brand-deep));
    }

    .logo-wrap { text-align: center; }

    .logo {
      width: 86px;
      height: 86px;
      border-radius: 14px;
      object-fit: contain;
      background: #fff;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 8px;
    }

    .logo-input {
      margin-top: 8px;
      font-size: 11px;
      color: #fff;
      background: rgba(255,255,255,0.2);
      padding: 6px 8px;
      border-radius: 8px;
      display: inline-block;
      cursor: pointer;
    }

    .brand-main {
      flex: 1;
      min-width: 0;
    }

    .brand-main h1 {
      font-family: 'Playfair Display', serif;
      font-size: 31px;
      line-height: 1.2;
      margin-bottom: 4px;
      word-break: break-word;
    }

    .brand-main .sub { opacity: 0.9; font-weight: 500; margin-bottom: 8px; }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
      background: rgba(191, 148, 70, 0.95);
      color: #fff;
    }

    .content {
      padding: 22px;
      display: grid;
      gap: 16px;
    }

    .section {
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 16px;
      background: #fff;
    }

    .section h2 {
      font-family: 'Playfair Display', serif;
      color: var(--brand);
      margin-bottom: 12px;
      font-size: 21px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section h2::before {
      content: '';
      width: 4px;
      height: 22px;
      border-radius: 4px;
      background: var(--accent);
    }

    .grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(2, minmax(0,1fr));
    }

    .grid-3 { grid-template-columns: repeat(3, minmax(0,1fr)); }

    .field label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 700;
      margin-bottom: 6px;
      display: block;
    }

    input, select, textarea {
      width: 100%;
      border: 1.5px solid var(--line);
      border-radius: 10px;
      font: inherit;
      font-size: 14px;
      padding: 10px 12px;
      background: #fff;
      transition: border-color .2s ease, box-shadow .2s ease;
    }

    textarea {
      min-height: 92px;
      resize: vertical;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(122, 31, 31, 0.12);
    }

    .hint { font-size: 12px; color: var(--muted); margin-top: 6px; }

    .line-items {
      display: grid;
      gap: 10px;
      margin-bottom: 10px;
    }

    .line-item {
      display: grid;
      grid-template-columns: 2fr .7fr 1fr auto;
      gap: 8px;
      align-items: end;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      background: #fbfbfb;
    }

    .line-item .remove-item {
      width: 34px;
      height: 34px;
      border: none;
      border-radius: 8px;
      background: var(--danger);
      color: #fff;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
    }

    .add-item {
      border: none;
      border-radius: 10px;
      padding: 9px 14px;
      background: var(--accent);
      color: #fff;
      font-weight: 800;
      font-size: 13px;
      cursor: pointer;
    }

    .summary {
      margin-top: 12px;
      border-radius: 14px;
      padding: 14px;
      color: #fff;
      background: linear-gradient(135deg, #5b1414, #8c2727);
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      padding: 7px 0;
      gap: 10px;
      font-size: 14px;
    }

    .summary-row.total {
      font-weight: 800;
      font-size: 18px;
      margin-top: 8px;
      border-top: 1px solid rgba(255,255,255,0.35);
      padding-top: 10px;
    }

    .discount-wrap {
      margin-top: 7px;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      border-radius: 10px;
      background: rgba(255,255,255,0.12);
    }

    .discount-wrap input {
      max-width: 110px;
      background: rgba(255,255,255,0.16);
      color: #fff;
      border-color: rgba(255,255,255,0.3);
    }

    .dual-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 8px;
    }

    .portfolio-head {
      display: grid;
      gap: 8px;
      grid-template-columns: 1fr 1fr 1fr auto;
      margin-bottom: 10px;
    }

    .portfolio-add {
      border: none;
      border-radius: 10px;
      padding: 10px 14px;
      background: var(--brand);
      color: #fff;
      font-weight: 800;
      cursor: pointer;
      min-width: 120px;
    }

    .portfolio-upload {
      border: 1.5px dashed #d1d5db;
      border-radius: 12px;
      padding: 16px;
      text-align: center;
      background: #fafafa;
      cursor: pointer;
      margin-bottom: 10px;
    }

    .portfolio-upload:hover {
      border-color: var(--brand);
      background: #fff;
    }

    .portfolio-grid {
      display: grid;
      gap: 10px;
      grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
    }

    .portfolio-item {
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
      position: relative;
    }

    .portfolio-item img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      background: #f3f4f6;
    }

    .portfolio-body {
      padding: 10px;
      display: grid;
      gap: 6px;
    }

    .portfolio-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--ink);
      word-break: break-word;
    }

    .portfolio-link {
      font-size: 12px;
      color: var(--brand);
      text-decoration: none;
      word-break: break-all;
    }

    .portfolio-remove {
      position: absolute;
      top: 6px;
      right: 6px;
      border: none;
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: rgba(220, 38, 38, 0.95);
      color: #fff;
      font-weight: 800;
      cursor: pointer;
    }

    .signature-wrap {
      border: 1px solid var(--line);
      border-radius: 12px;
      overflow: hidden;
      background: #fcfcfc;
    }

    #signaturePad {
      width: 100%;
      height: 180px;
      display: block;
      background: #fff;
      touch-action: none;
      cursor: crosshair;
      border-bottom: 1px solid var(--line);
    }

    .signature-actions {
      display: flex;
      gap: 8px;
      padding: 10px;
      flex-wrap: wrap;
    }

    .ghost-btn, .danger-btn {
      border: 1px solid var(--line);
      border-radius: 10px;
      background: #fff;
      color: var(--ink);
      padding: 8px 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 13px;
    }

    .danger-btn {
      border-color: rgba(220, 38, 38, 0.35);
      color: var(--danger);
    }

    .footer {
      border-top: 1px solid var(--line);
      padding-top: 14px;
      margin-top: 8px;
      display: grid;
      gap: 5px;
      font-size: 13px;
      color: var(--muted);
    }

    .footer strong { color: var(--ink); }

    .footer a {
      color: var(--brand);
      text-decoration: none;
      font-weight: 700;
    }

    .actions {
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
    }

    .action {
      border: none;
      border-radius: 12px;
      padding: 11px 16px;
      font-weight: 800;
      cursor: pointer;
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .action.primary { background: var(--brand); color: #fff; }
    .action.secondary { background: var(--accent); color: #fff; }
    .action.success { background: var(--ok); color: #fff; }

    .action:hover { filter: brightness(0.95); }

    .hidden { display: none !important; }

    @media print {
      body { padding: 0; background: #fff; }
      .lang-toggle, .actions, .logo-input, #logoInput, #portfolioInput, .portfolio-upload, .portfolio-head, .add-item, .remove-item, .portfolio-remove, .signature-actions {
        display: none !important;
      }
      .sheet { box-shadow: none; border: none; border-radius: 0; }
      .content { padding: 12px; }
      input, select, textarea { border-color: #ddd; box-shadow: none !important; }
    }

    @media (max-width: 860px) {
      .grid, .grid-3, .dual-grid { grid-template-columns: 1fr; }
      .line-item { grid-template-columns: 1fr; }
      .portfolio-head { grid-template-columns: 1fr; }
      .hero { flex-direction: column; text-align: center; }
      .brand-main h1 { font-size: 27px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="lang-toggle">
      <button id="btnEN" class="active" onclick="setLang('en')">EN</button>
      <button id="btnAR" onclick="setLang('ar')">AR</button>
    </div>

    <div class="sheet" id="proposal">
      <header class="hero">
        <div class="logo-wrap">
          <img id="logo" class="logo" src="https://omoginteriors.com/logo.png" alt="Company Logo">
          <label class="logo-input" for="logoInput" data-i18n="changeLogo">Change Logo</label>
          <input id="logoInput" type="file" accept="image/*" class="hidden" onchange="uploadLogo(event)">
        </div>
        <div class="brand-main">
          <h1 id="brandTitle"></h1>
          <div class="sub" id="brandSub"></div>
          <span class="badge" id="badgeText"></span>
        </div>
      </header>

      <main class="content">
        <section class="section">
          <h2 data-i18n="companyProfile">Company Profile (Editable)</h2>
          <div class="dual-grid">
            <div class="field"><label data-i18n="companyNameEn">Company Name (EN)</label><input id="companyNameEn" value="OMO G INTERIOR DECORATION" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="companyNameAr">Company Name (AR)</label><input id="companyNameAr" value="Ø£ÙˆÙ…ÙˆØ¬ Ù„Ù„Ø¯ÙŠÙƒÙˆØ± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="companyTagEn">Tagline (EN)</label><input id="companyTaglineEn" value="Trading & Interior Design Specialists - Doha, Qatar" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="companyTagAr">Tagline (AR)</label><input id="companyTaglineAr" value="Ø§Ù„ØªØ¬Ø§Ø±Ø© ÙˆØ§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ - Ø§Ù„Ø¯ÙˆØ­Ø©ØŒ Ù‚Ø·Ø±" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="offerBadgeEn">Offer Badge (EN)</label><input id="offerBadgeEn" value="Syaanh Fast Offer" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="offerBadgeAr">Offer Badge (AR)</label><input id="offerBadgeAr" value="Ø¹Ø±Ø¶ ØµÙŠØ§Ù†Ø© Ø³Ø±ÙŠØ¹" oninput="refreshTexts()"></div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="clientInfo">Client Information</h2>
          <div class="grid">
            <div class="field"><label data-i18n="clientName">Client Name</label><input id="client" data-i18n-placeholder="clientNamePlaceholder" placeholder="Enter client name"></div>
            <div class="field"><label data-i18n="location">Location</label><input id="location" data-i18n-placeholder="locationPlaceholder" placeholder="Area, Doha"></div>
            <div class="field"><label data-i18n="phone">Phone Number</label><input id="phone" type="tel" placeholder="+974 XXXX XXXX"></div>
            <div class="field"><label data-i18n="offerDate">Offer Date</label><input id="date" type="date"></div>
            <div class="field"><label data-i18n="offerRef">Offer Reference</label><input id="offerRef" placeholder="OFF-2026-001"></div>
            <div class="field"><label data-i18n="currency">Currency</label>
              <select id="currency" onchange="calculateTotal()">
                <option value="QAR">QAR</option>
                <option value="USD">USD</option>
                <option value="SAR">SAR</option>
                <option value="AED">AED</option>
              </select>
            </div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="serviceDetails">Service Details</h2>
          <div class="grid">
            <div class="field">
              <label data-i18n="serviceType">Service Type</label>
              <select id="serviceType" onchange="updateServiceScope()">
                <option value="" data-en="Select Service" data-ar="Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø©">Select Service</option>
                <option value="gypsum" data-en="Gypsum Ceiling Installation" data-ar="ØªØ±ÙƒÙŠØ¨ Ø¬Ø¨Ø³ Ø§Ù„Ø£Ø³Ù‚Ù">Gypsum Ceiling Installation</option>
                <option value="painting" data-en="Painting & Decoration" data-ar="Ø¯Ù‡Ø§Ù† ÙˆØ¯ÙŠÙƒÙˆØ±">Painting & Decoration</option>
                <option value="3dwall" data-en="3D Wall Panels" data-ar="Ø£Ù„ÙˆØ§Ø­ Ø¬Ø¯Ø±Ø§Ù† Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯">3D Wall Panels</option>
                <option value="furniture" data-en="Custom Furniture" data-ar="Ø£Ø«Ø§Ø« Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨">Custom Furniture</option>
                <option value="renovation" data-en="Full Renovation" data-ar="ØªØ¬Ø¯ÙŠØ¯ ÙƒØ§Ù…Ù„">Full Renovation</option>
                <option value="turnkey" data-en="Turnkey Interior Project" data-ar="Ù…Ø´Ø±ÙˆØ¹ Ø¯Ø§Ø®Ù„ÙŠ Ù…ØªÙƒØ§Ù…Ù„">Turnkey Interior Project</option>
                <option value="custom" data-en="Custom Service" data-ar="Ø®Ø¯Ù…Ø© Ù…Ø®ØµØµØ©">Custom Service</option>
              </select>
            </div>
            <div class="field">
              <label data-i18n="duration">Duration</label>
              <select id="duration">
                <option value="" data-en="Select duration" data-ar="Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯Ø©">Select duration</option>
                <option data-en="1-2 days" data-ar="1-2 ÙŠÙˆÙ…">1-2 days</option>
                <option data-en="3-5 days" data-ar="3-5 Ø£ÙŠØ§Ù…">3-5 days</option>
                <option data-en="1 week" data-ar="Ø£Ø³Ø¨ÙˆØ¹">1 week</option>
                <option data-en="2 weeks" data-ar="Ø£Ø³Ø¨ÙˆØ¹Ø§Ù†">2 weeks</option>
                <option data-en="3-4 weeks" data-ar="3-4 Ø£Ø³Ø§Ø¨ÙŠØ¹">3-4 weeks</option>
                <option data-en="1-2 months" data-ar="1-2 Ø´Ù‡Ø±">1-2 months</option>
              </select>
            </div>
            <div class="field"><label data-i18n="startDate">Estimated Start Date</label><input id="startDate" type="date"></div>
            <div class="field"><label data-i18n="validityDays">Offer Validity (Days)</label><input id="validityDays" type="number" min="1" value="7"></div>
          </div>
          <div class="field" style="margin-top:10px;">
            <label data-i18n="scopeOfWork">Scope of Work</label>
            <textarea id="scope" data-i18n-placeholder="scopePlaceholder">- Gypsum ceiling installation
- LED cove lighting provision
- Smooth finishing and paint
- Clean delivery</textarea>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="pricingBreakdown">Pricing Breakdown</h2>
          <div id="lineItems" class="line-items"></div>
          <button type="button" class="add-item" onclick="addLineItem()" data-i18n="addLineItem">+ Add Line Item</button>

          <div class="summary">
            <div class="summary-row"><span data-i18n="subtotal">Subtotal</span><span id="subtotalAmount">QAR 0.00</span></div>
            <div class="discount-wrap">
              <label style="font-size:12px;font-weight:800;color:#fff" data-i18n="discount">Discount (%)</label>
              <input id="discountPercent" type="number" min="0" max="100" placeholder="0" oninput="calculateTotal()">
              <span id="discountAmount">- QAR 0.00</span>
            </div>
            <div class="summary-row total"><span data-i18n="total">TOTAL</span><span id="totalAmount">QAR 0.00</span></div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="whyChoose">Why Choose Us (Editable)</h2>
          <div class="dual-grid">
            <div class="field">
              <label data-i18n="highlightsEn">Highlights (EN, one per line)</label>
              <textarea id="highlightsEn">Licensed & Registered in Qatar (CR: 235664)
45+ Successfully Completed Projects
Professional Team with Years of Experience
High-Quality Materials & Clean Finishing
Warranty on All Work
Transparent Pricing - No Hidden Costs</textarea>
            </div>
            <div class="field">
              <label data-i18n="highlightsAr">Highlights (AR, one per line)</label>
              <textarea id="highlightsAr">Ù…Ø±Ø®Øµ ÙˆÙ…Ø³Ø¬Ù„ ÙÙŠ Ù‚Ø·Ø± (Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: 235664)
Ø£ÙƒØ«Ø± Ù…Ù† 45 Ù…Ø´Ø±ÙˆØ¹Ø§Ù‹ Ù…Ù†Ø¬Ø²Ø§Ù‹ Ø¨Ù†Ø¬Ø§Ø­
ÙØ±ÙŠÙ‚ Ø§Ø­ØªØ±Ø§ÙÙŠ Ø¨Ø®Ø¨Ø±Ø© Ø·ÙˆÙŠÙ„Ø©
Ù…ÙˆØ§Ø¯ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØªØ´Ø·ÙŠØ¨ Ù†Ø¸ÙŠÙ
Ø¶Ù…Ø§Ù† Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„
ØªØ³Ø¹ÙŠØ± ÙˆØ§Ø¶Ø­ Ø¯ÙˆÙ† ØªÙƒØ§Ù„ÙŠÙ Ù…Ø®ÙÙŠØ©</textarea>
            </div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="portfolio">Portfolio Links & Images</h2>
          <div class="portfolio-upload" onclick="document.getElementById('portfolioInput').click()">
            <div style="font-size:28px">ğŸ“¸</div>
            <div data-i18n="uploadPortfolio">Click to upload portfolio images</div>
          </div>
          <input id="portfolioInput" type="file" accept="image/*" multiple class="hidden" onchange="addPortfolioImages(event)">

          <div class="portfolio-head">
            <input id="portfolioTitleInput" type="text" data-i18n-placeholder="portfolioTitlePlaceholder" placeholder="Project title">
            <input id="portfolioLinkInput" type="url" data-i18n-placeholder="portfolioLinkPlaceholder" placeholder="https://your-portfolio-link.com/project">
            <input id="portfolioThumbInput" type="url" data-i18n-placeholder="portfolioThumbPlaceholder" placeholder="Optional thumbnail image URL">
            <button type="button" class="portfolio-add" onclick="addPortfolioLink()" data-i18n="addLink">Add Link</button>
          </div>
          <div id="portfolio" class="portfolio-grid"></div>
          <p class="hint" data-i18n="portfolioHint">You can add image uploads and external portfolio links together.</p>
        </section>

        <section class="section">
          <h2 data-i18n="terms">Terms & Conditions (Editable)</h2>
          <div class="dual-grid">
            <div class="field">
              <label data-i18n="paymentTermsEn">Payment Terms (EN, one per line)</label>
              <textarea id="paymentTermsEn">50% deposit required to start work
50% balance due upon project completion
Payments accepted via cash, bank transfer, or card</textarea>
            </div>
            <div class="field">
              <label data-i18n="paymentTermsAr">Payment Terms (AR, one per line)</label>
              <textarea id="paymentTermsAr">50Ùª Ø¯ÙØ¹Ø© Ù…Ù‚Ø¯Ù…Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„
50Ùª Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹ Ø£Ùˆ ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ Ø£Ùˆ Ø¨Ø·Ø§Ù‚Ø©</textarea>
            </div>
            <div class="field">
              <label data-i18n="warrantyEn">Warranty (EN)</label>
              <textarea id="warrantyEn">All work comes with a 1-year warranty covering workmanship defects.</textarea>
            </div>
            <div class="field">
              <label data-i18n="warrantyAr">Warranty (AR)</label>
              <textarea id="warrantyAr">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ØªØ´Ù…Ù„ Ø¶Ù…Ø§Ù† Ù„Ù…Ø¯Ø© Ø³Ù†Ø© Ø¶Ø¯ Ø¹ÙŠÙˆØ¨ Ø§Ù„ØªÙ†ÙÙŠØ°.</textarea>
            </div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="digitalSignature">Digital Signature</h2>
          <div class="signature-wrap">
            <canvas id="signaturePad"></canvas>
            <div class="signature-actions">
              <button type="button" class="ghost-btn" onclick="saveSignature()" data-i18n="saveSignature">Save Signature</button>
              <button type="button" class="danger-btn" onclick="clearSignature()" data-i18n="clearSignature">Clear Signature</button>
              <span id="signatureStatus" class="hint" data-i18n="signatureHint">Sign using mouse or touch, then click Save Signature.</span>
            </div>
          </div>
          <div class="grid" style="margin-top:10px;">
            <div class="field"><label data-i18n="signName">Signer Name</label><input id="signerName" placeholder="Client or representative"></div>
            <div class="field"><label data-i18n="signTitle">Signer Title</label><input id="signerTitle" placeholder="Manager / Owner"></div>
            <div class="field"><label data-i18n="signDate">Signature Date</label><input id="signatureDate" type="date"></div>
          </div>
        </section>

        <section class="section">
          <h2 data-i18n="contactFooter">Contact & Footer (Editable)</h2>
          <div class="grid">
            <div class="field"><label data-i18n="phone">Phone</label><input id="companyPhone" value="+974 7102 1381" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="email">Email</label><input id="companyEmail" value="info@omoginteriors.com" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="website">Website</label><input id="companyWebsite" value="https://omoginteriors.com" oninput="refreshTexts()"></div>
            <div class="field"><label data-i18n="social">Instagram / TikTok</label><input id="companySocial" value="Instagram: @omogdecor | TikTok: @omog_decor" oninput="refreshTexts()"></div>
          </div>
          <div class="dual-grid">
            <div class="field"><label data-i18n="addressEn">Address (EN)</label><textarea id="companyAddressEn" oninput="refreshTexts()">Office 70, 2nd Floor Block E, Al Mirqab Mall, Doha</textarea></div>
            <div class="field"><label data-i18n="addressAr">Address (AR)</label><textarea id="companyAddressAr" oninput="refreshTexts()">Ù…ÙƒØªØ¨ 70ØŒ Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø«Ø§Ù†ÙŠØŒ Ø¨Ù„ÙˆÙƒ EØŒ Ø§Ù„Ù…Ø±Ù‚Ø§Ø¨ Ù…ÙˆÙ„ØŒ Ø§Ù„Ø¯ÙˆØ­Ø©</textarea></div>
          </div>

          <div class="footer" id="footerPreview">
            <strong id="footerCompany">OMO G Trading And Interior Decoration</strong>
            <div><span>ğŸ“ </span><a id="footerPhoneLink" href="tel:+97471021381">+974 7102 1381</a></div>
            <div><span>ğŸ“§ </span><a id="footerEmailLink" href="mailto:info@omoginteriors.com">info@omoginteriors.com</a></div>
            <div><span>ğŸŒ </span><a id="footerWebsiteLink" target="_blank" href="https://omoginteriors.com">omoginteriors.com</a></div>
            <div id="footerAddress">Office 70, 2nd Floor Block E, Al Mirqab Mall, Doha</div>
            <div id="footerSocial">CR No: 235664 | Instagram: @omogdecor | TikTok: @omog_decor</div>
          </div>
        </section>
      </main>
    </div>

    <div class="actions">
      <button class="action primary" onclick="window.print()"><span>ğŸ–¨ï¸</span><span data-i18n="exportPdf">Export PDF</span></button>
      <button class="action secondary" onclick="shareWhatsApp()"><span>ğŸ’¬</span><span data-i18n="shareWhatsApp">Share via WhatsApp</span></button>
      <button class="action success" onclick="copyToClipboard()"><span>ğŸ“‹</span><span data-i18n="copySummary">Copy Summary</span></button>
    </div>
  </div>

  <script>
    const i18n = {
      en: {
        changeLogo: 'Change Logo',
        companyProfile: 'Company Profile (Editable)',
        companyNameEn: 'Company Name (EN)',
        companyNameAr: 'Company Name (AR)',
        companyTagEn: 'Tagline (EN)',
        companyTagAr: 'Tagline (AR)',
        offerBadgeEn: 'Offer Badge (EN)',
        offerBadgeAr: 'Offer Badge (AR)',
        clientInfo: 'Client Information',
        clientName: 'Client Name',
        clientNamePlaceholder: 'Enter client name',
        location: 'Location',
        locationPlaceholder: 'Area, Doha',
        phone: 'Phone Number',
        email: 'Email',
        website: 'Website',
        social: 'Instagram / TikTok',
        offerDate: 'Offer Date',
        offerRef: 'Offer Reference',
        currency: 'Currency',
        serviceDetails: 'Service Details',
        serviceType: 'Service Type',
        duration: 'Duration',
        startDate: 'Estimated Start Date',
        validityDays: 'Offer Validity (Days)',
        scopeOfWork: 'Scope of Work',
        scopePlaceholder: 'Describe work scope...',
        pricingBreakdown: 'Pricing Breakdown',
        addLineItem: '+ Add Line Item',
        subtotal: 'Subtotal',
        discount: 'Discount (%)',
        total: 'TOTAL',
        whyChoose: 'Why Choose Us (Editable)',
        highlightsEn: 'Highlights (EN, one per line)',
        highlightsAr: 'Highlights (AR, one per line)',
        portfolio: 'Portfolio Links & Images',
        uploadPortfolio: 'Click to upload portfolio images',
        portfolioTitlePlaceholder: 'Project title',
        portfolioLinkPlaceholder: 'https://your-portfolio-link.com/project',
        portfolioThumbPlaceholder: 'Optional thumbnail image URL',
        addLink: 'Add Link',
        portfolioHint: 'You can add image uploads and external portfolio links together.',
        terms: 'Terms & Conditions (Editable)',
        paymentTermsEn: 'Payment Terms (EN, one per line)',
        paymentTermsAr: 'Payment Terms (AR, one per line)',
        warrantyEn: 'Warranty (EN)',
        warrantyAr: 'Warranty (AR)',
        digitalSignature: 'Digital Signature',
        saveSignature: 'Save Signature',
        clearSignature: 'Clear Signature',
        signatureHint: 'Sign using mouse or touch, then click Save Signature.',
        signName: 'Signer Name',
        signTitle: 'Signer Title',
        signDate: 'Signature Date',
        contactFooter: 'Contact & Footer (Editable)',
        addressEn: 'Address (EN)',
        addressAr: 'Address (AR)',
        exportPdf: 'Export PDF',
        shareWhatsApp: 'Share via WhatsApp',
        copySummary: 'Copy Summary',
        itemDescription: 'Description',
        qty: 'Qty',
        price: 'Price',
        remove: 'Remove',
        signatureSaved: 'Signature saved.',
        signatureCleared: 'Signature cleared.',
        copied: 'Offer summary copied to clipboard.'
      },
      ar: {
        changeLogo: 'ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¹Ø§Ø±',
        companyProfile: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)',
        companyNameEn: 'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (EN)',
        companyNameAr: 'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© (AR)',
        companyTagEn: 'Ø§Ù„ÙˆØµÙ (EN)',
        companyTagAr: 'Ø§Ù„ÙˆØµÙ (AR)',
        offerBadgeEn: 'Ø´Ø§Ø±Ø© Ø§Ù„Ø¹Ø±Ø¶ (EN)',
        offerBadgeAr: 'Ø´Ø§Ø±Ø© Ø§Ù„Ø¹Ø±Ø¶ (AR)',
        clientInfo: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„',
        clientName: 'Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„',
        clientNamePlaceholder: 'Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„',
        location: 'Ø§Ù„Ù…ÙˆÙ‚Ø¹',
        locationPlaceholder: 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©ØŒ Ø§Ù„Ø¯ÙˆØ­Ø©',
        phone: 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ',
        email: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
        website: 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
        social: 'Ø¥Ù†Ø³ØªØºØ±Ø§Ù… / ØªÙŠÙƒ ØªÙˆÙƒ',
        offerDate: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø±Ø¶',
        offerRef: 'Ø±Ù‚Ù… Ø§Ù„Ø¹Ø±Ø¶',
        currency: 'Ø§Ù„Ø¹Ù…Ù„Ø©',
        serviceDetails: 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©',
        serviceType: 'Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©',
        duration: 'Ø§Ù„Ù…Ø¯Ø©',
        startDate: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹',
        validityDays: 'ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¹Ø±Ø¶ (Ø£ÙŠØ§Ù…)',
        scopeOfWork: 'Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„',
        scopePlaceholder: 'ØµÙ Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„...',
        pricingBreakdown: 'ØªÙØµÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±',
        addLineItem: '+ Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯',
        subtotal: 'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ',
        discount: 'Ø§Ù„Ø®ØµÙ… (%)',
        total: 'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ',
        whyChoose: 'Ù„Ù…Ø§Ø°Ø§ ØªØ®ØªØ§Ø±Ù†Ø§ (Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)',
        highlightsEn: 'Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (ENØŒ Ø³Ø·Ø± Ù„ÙƒÙ„ Ù†Ù‚Ø·Ø©)',
        highlightsAr: 'Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© (ARØŒ Ø³Ø·Ø± Ù„ÙƒÙ„ Ù†Ù‚Ø·Ø©)',
        portfolio: 'Ù…Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ (Ø±ÙˆØ§Ø¨Ø· ÙˆØµÙˆØ±)',
        uploadPortfolio: 'Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
        portfolioTitlePlaceholder: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹',
        portfolioLinkPlaceholder: 'https://your-portfolio-link.com/project',
        portfolioThumbPlaceholder: 'Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…ØµØºØ±Ø© Ø§Ø®ØªÙŠØ§Ø±ÙŠ',
        addLink: 'Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·',
        portfolioHint: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ØµÙˆØ± ÙˆØ±ÙˆØ§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠØ© Ù…Ø¹Ø§Ù‹.',
        terms: 'Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)',
        paymentTermsEn: 'Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙØ¹ (ENØŒ Ø³Ø·Ø± Ù„ÙƒÙ„ Ù†Ù‚Ø·Ø©)',
        paymentTermsAr: 'Ø´Ø±ÙˆØ· Ø§Ù„Ø¯ÙØ¹ (ARØŒ Ø³Ø·Ø± Ù„ÙƒÙ„ Ù†Ù‚Ø·Ø©)',
        warrantyEn: 'Ø§Ù„Ø¶Ù…Ø§Ù† (EN)',
        warrantyAr: 'Ø§Ù„Ø¶Ù…Ø§Ù† (AR)',
        digitalSignature: 'Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠ',
        saveSignature: 'Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹',
        clearSignature: 'Ù…Ø³Ø­ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹',
        signatureHint: 'ÙˆÙ‚Ù‘Ø¹ Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ù„Ù…Ø³ Ø«Ù… Ø§Ø¶ØºØ· Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹.',
        signName: 'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ù‘Ø¹',
        signTitle: 'ØµÙØ© Ø§Ù„Ù…ÙˆÙ‚Ù‘Ø¹',
        signDate: 'ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆÙ‚ÙŠØ¹',
        contactFooter: 'Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„ØªØ°ÙŠÙŠÙ„ (Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)',
        addressEn: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (EN)',
        addressAr: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (AR)',
        exportPdf: 'ØªØµØ¯ÙŠØ± PDF',
        shareWhatsApp: 'Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨',
        copySummary: 'Ù†Ø³Ø® Ø§Ù„Ù…Ù„Ø®Øµ',
        itemDescription: 'Ø§Ù„ÙˆØµÙ',
        qty: 'Ø§Ù„ÙƒÙ…ÙŠØ©',
        price: 'Ø§Ù„Ø³Ø¹Ø±',
        remove: 'Ø­Ø°Ù',
        signatureSaved: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹.',
        signatureCleared: 'ØªÙ… Ù…Ø³Ø­ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹.',
        copied: 'ØªÙ… Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ø±Ø¶.'
      }
    };

    let currentLang = 'en';
    const serviceTemplates = {
      en: {
        gypsum: '- Gypsum ceiling installation/repair\n- LED cove lighting provision (optional)\n- Smooth finishing and paint\n- Clean delivery and site cleanup',
        painting: '- Wall preparation and filling\n- Premium quality paint application\n- Two coats minimum\n- Clean finishing and touch-ups',
        '3dwall': '- 3D wall panel installation\n- Surface preparation\n- Professional mounting\n- LED backlighting (optional)',
        furniture: '- Custom furniture design\n- Material selection consultation\n- Professional installation\n- Finishing touches',
        renovation: '- Space planning and design\n- Demolition and preparation\n- Installation of new elements\n- Finishing and handover',
        turnkey: '- Complete design concept\n- Material procurement\n- Full project execution\n- Furniture and accessories\n- Final handover'
      },
      ar: {
        gypsum: '- ØªØ±ÙƒÙŠØ¨/Ø¥ØµÙ„Ø§Ø­ Ø¬Ø¨Ø³ Ø§Ù„Ø£Ø³Ù‚Ù\n- ØªÙˆÙÙŠØ± Ø¥Ø¶Ø§Ø¡Ø© Ù…Ø®ÙÙŠØ© LED (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)\n- ØªØ´Ø·ÙŠØ¨ Ù†Ø§Ø¹Ù… ÙˆØ¯Ù‡Ø§Ù†\n- ØªØ³Ù„ÙŠÙ… Ù†Ø¸ÙŠÙ Ù…Ø¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
        painting: '- ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¬Ø¯Ø±Ø§Ù† ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¹ÙŠÙˆØ¨\n- Ø¯Ù‡Ø§Ù† Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©\n- Ø·Ø¨Ù‚ØªØ§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„\n- ØªØ´Ø·ÙŠØ¨ Ù†Ù‡Ø§Ø¦ÙŠ ÙˆØªÙ†Ø¸ÙŠÙ',
        '3dwall': '- ØªØ±ÙƒÙŠØ¨ Ø£Ù„ÙˆØ§Ø­ Ø¬Ø¯Ø§Ø±ÙŠØ© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯\n- ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø³Ø·Ø­\n- ØªØ«Ø¨ÙŠØª Ø§Ø­ØªØ±Ø§ÙÙŠ\n- Ø¥Ø¶Ø§Ø¡Ø© Ø®Ù„ÙÙŠØ© LED (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)',
        furniture: '- ØªØµÙ…ÙŠÙ… Ø£Ø«Ø§Ø« Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨\n- Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ§Ø¯\n- ØªØ±ÙƒÙŠØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠ\n- Ø§Ù„Ù„Ù…Ø³Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©',
        renovation: '- ØªØ®Ø·ÙŠØ· ÙˆØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø³Ø§Ø­Ø©\n- Ø£Ø¹Ù…Ø§Ù„ Ø¥Ø²Ø§Ù„Ø© ÙˆØªØ¬Ù‡ÙŠØ²\n- ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©\n- Ø§Ù„ØªØ´Ø·ÙŠØ¨ ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…',
        turnkey: '- Ù…ÙÙ‡ÙˆÙ… ØªØµÙ…ÙŠÙ… Ù…ØªÙƒØ§Ù…Ù„\n- ØªÙˆØ±ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§Ø¯\n- ØªÙ†ÙÙŠØ° ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹\n- Ø£Ø«Ø§Ø« ÙˆØ§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª\n- ØªØ³Ù„ÙŠÙ… Ù†Ù‡Ø§Ø¦ÙŠ'
      }
    };

    const portfolioItems = [];
    const signatureCanvas = document.getElementById('signaturePad');
    const signatureCtx = signatureCanvas.getContext('2d');
    let drawing = false;
    let hasSignature = false;

    function normalizePhone(phone) {
      return (phone || '').replace(/[^\d+]/g, '');
    }

    function getLangText(enId, arId) {
      const enVal = (document.getElementById(enId)?.value || '').trim();
      const arVal = (document.getElementById(arId)?.value || '').trim();
      return currentLang === 'ar' ? (arVal || enVal) : (enVal || arVal);
    }

    function translateUi() {
      const dict = i18n[currentLang];
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        if (dict[key]) el.placeholder = dict[key];
      });

      document.querySelectorAll('#serviceType option, #duration option').forEach(option => {
        const key = currentLang === 'ar' ? 'ar' : 'en';
        if (option.dataset[key]) option.textContent = option.dataset[key];
      });

      document.body.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = currentLang;
      document.getElementById('btnEN').classList.toggle('active', currentLang === 'en');
      document.getElementById('btnAR').classList.toggle('active', currentLang === 'ar');

      renderLineItemLabels();
      refreshTexts();
      renderPortfolio();
    }

    function refreshTexts() {
      document.getElementById('brandTitle').textContent = getLangText('companyNameEn', 'companyNameAr');
      document.getElementById('brandSub').textContent = getLangText('companyTaglineEn', 'companyTaglineAr');
      document.getElementById('badgeText').textContent = getLangText('offerBadgeEn', 'offerBadgeAr');

      const phone = document.getElementById('companyPhone').value.trim();
      const email = document.getElementById('companyEmail').value.trim();
      const website = document.getElementById('companyWebsite').value.trim();
      const websiteLabel = website.replace(/^https?:\/\//, '') || website;
      const footerCompany = getLangText('companyNameEn', 'companyNameAr');
      const footerAddress = getLangText('companyAddressEn', 'companyAddressAr');

      document.getElementById('footerCompany').textContent = footerCompany || '-';
      const phoneLink = document.getElementById('footerPhoneLink');
      phoneLink.textContent = phone || '-';
      phoneLink.href = `tel:${normalizePhone(phone)}`;

      const emailLink = document.getElementById('footerEmailLink');
      emailLink.textContent = email || '-';
      emailLink.href = `mailto:${email}`;

      const websiteLink = document.getElementById('footerWebsiteLink');
      websiteLink.textContent = websiteLabel || '-';
      websiteLink.href = website || '#';

      document.getElementById('footerAddress').textContent = footerAddress || '-';
      document.getElementById('footerSocial').textContent = `CR No: 235664 | ${document.getElementById('companySocial').value.trim() || '-'}`;
    }

    function setLang(lang) {
      currentLang = lang;
      translateUi();
    }

    function uploadLogo(event) {
      const file = event.target.files && event.target.files[0];
      if (!file) return;
      document.getElementById('logo').src = URL.createObjectURL(file);
    }

    function newLineItemRow() {
      const item = document.createElement('div');
      item.className = 'line-item';
      item.innerHTML = `
        <div class="field">
          <label class="li-label-desc">Description</label>
          <input type="text" class="item-desc" placeholder="Item description">
        </div>
        <div class="field">
          <label class="li-label-qty">Qty</label>
          <input type="number" class="item-qty" min="1" value="1" oninput="calculateTotal()">
        </div>
        <div class="field">
          <label class="li-label-price">Price</label>
          <input type="number" class="item-price" min="0" placeholder="0" oninput="calculateTotal()">
        </div>
        <button type="button" class="remove-item" onclick="removeItem(this)">Ã—</button>
      `;
      return item;
    }

    function renderLineItemLabels() {
      const dict = i18n[currentLang];
      document.querySelectorAll('.li-label-desc').forEach(el => el.textContent = dict.itemDescription);
      document.querySelectorAll('.li-label-qty').forEach(el => el.textContent = dict.qty);
      document.querySelectorAll('.li-label-price').forEach(el => {
        el.textContent = `${dict.price} (${document.getElementById('currency').value})`;
      });
      document.querySelectorAll('.remove-item').forEach(btn => btn.title = dict.remove);
    }

    function addLineItem() {
      document.getElementById('lineItems').appendChild(newLineItemRow());
      renderLineItemLabels();
      calculateTotal();
    }

    function removeItem(button) {
      const parent = button.closest('.line-item');
      if (parent) parent.remove();
      calculateTotal();
    }

    function calculateTotal() {
      const currency = document.getElementById('currency').value || 'QAR';
      let subtotal = 0;
      document.querySelectorAll('.line-item').forEach(item => {
        const qty = parseFloat(item.querySelector('.item-qty')?.value || '0') || 0;
        const price = parseFloat(item.querySelector('.item-price')?.value || '0') || 0;
        subtotal += qty * price;
      });

      const discountPercent = parseFloat(document.getElementById('discountPercent').value || '0') || 0;
      const discountAmount = subtotal * Math.max(0, Math.min(100, discountPercent)) / 100;
      const total = subtotal - discountAmount;

      document.getElementById('subtotalAmount').textContent = `${currency} ${subtotal.toFixed(2)}`;
      document.getElementById('discountAmount').textContent = `- ${currency} ${discountAmount.toFixed(2)}`;
      document.getElementById('totalAmount').textContent = `${currency} ${total.toFixed(2)}`;

      renderLineItemLabels();
    }

    function updateServiceScope() {
      const serviceType = document.getElementById('serviceType').value;
      const template = serviceTemplates[currentLang][serviceType];
      if (template) {
        document.getElementById('scope').value = template;
      }
    }

    function addPortfolioImages(event) {
      const files = Array.from(event.target.files || []);
      files.forEach(file => {
        portfolioItems.push({
          id: crypto.randomUUID(),
          type: 'image',
          title: file.name,
          href: '',
          thumb: URL.createObjectURL(file)
        });
      });
      renderPortfolio();
      event.target.value = '';
    }

    function addPortfolioLink() {
      const title = document.getElementById('portfolioTitleInput').value.trim();
      const href = document.getElementById('portfolioLinkInput').value.trim();
      const thumb = document.getElementById('portfolioThumbInput').value.trim();

      if (!href) {
        alert(currentLang === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.' : 'Please enter a portfolio link.');
        return;
      }

      portfolioItems.push({
        id: crypto.randomUUID(),
        type: 'link',
        title: title || href,
        href,
        thumb: thumb || ''
      });

      document.getElementById('portfolioTitleInput').value = '';
      document.getElementById('portfolioLinkInput').value = '';
      document.getElementById('portfolioThumbInput').value = '';
      renderPortfolio();
    }

    function removePortfolioItem(id) {
      const index = portfolioItems.findIndex(item => item.id === id);
      if (index !== -1) portfolioItems.splice(index, 1);
      renderPortfolio();
    }

    function renderPortfolio() {
      const container = document.getElementById('portfolio');
      container.innerHTML = '';
      portfolioItems.forEach(item => {
        const card = document.createElement('article');
        card.className = 'portfolio-item';

        const thumb = item.thumb
          ? `<img src="${item.thumb}" alt="${item.title || 'Portfolio'}">`
          : '<img src="https://dummyimage.com/400x240/f2f2f2/7a1f1f&text=Portfolio+Link" alt="Portfolio link">';

        const safeTitle = item.title || (currentLang === 'ar' ? 'Ø±Ø§Ø¨Ø· Ù…Ø´Ø±ÙˆØ¹' : 'Project link');
        const linkText = currentLang === 'ar' ? 'ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·' : 'Open link';
        const body = item.href
          ? `<a class="portfolio-link" href="${item.href}" target="_blank" rel="noopener">${linkText}</a>`
          : '<span class="hint">Image upload</span>';

        card.innerHTML = `
          ${thumb}
          <button type="button" class="portfolio-remove" onclick="removePortfolioItem('${item.id}')">Ã—</button>
          <div class="portfolio-body">
            <div class="portfolio-title">${safeTitle}</div>
            ${body}
          </div>
        `;
        container.appendChild(card);
      });
    }

    function resizeCanvas() {
      const ratio = Math.max(window.devicePixelRatio || 1, 1);
      const displayWidth = signatureCanvas.clientWidth;
      const displayHeight = signatureCanvas.clientHeight;
      signatureCanvas.width = Math.floor(displayWidth * ratio);
      signatureCanvas.height = Math.floor(displayHeight * ratio);
      signatureCtx.setTransform(ratio, 0, 0, ratio, 0, 0);
      signatureCtx.lineWidth = 2;
      signatureCtx.lineCap = 'round';
      signatureCtx.strokeStyle = '#111827';
    }

    function getCanvasPos(evt) {
      const rect = signatureCanvas.getBoundingClientRect();
      const source = evt.touches ? evt.touches[0] : evt;
      return {
        x: source.clientX - rect.left,
        y: source.clientY - rect.top
      };
    }

    function startDraw(evt) {
      drawing = true;
      const p = getCanvasPos(evt);
      signatureCtx.beginPath();
      signatureCtx.moveTo(p.x, p.y);
      evt.preventDefault();
    }

    function draw(evt) {
      if (!drawing) return;
      const p = getCanvasPos(evt);
      signatureCtx.lineTo(p.x, p.y);
      signatureCtx.stroke();
      hasSignature = true;
      evt.preventDefault();
    }

    function endDraw() {
      drawing = false;
      signatureCtx.closePath();
    }

    function clearSignature() {
      signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
      hasSignature = false;
      document.getElementById('signatureStatus').textContent = i18n[currentLang].signatureCleared;
    }

    function saveSignature() {
      if (!hasSignature) {
        document.getElementById('signatureStatus').textContent = currentLang === 'ar'
          ? 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙ‚ÙŠØ¹ Ù„Ù„Ø­ÙØ¸.'
          : 'No signature to save yet.';
        return;
      }
      document.getElementById('signatureStatus').textContent = i18n[currentLang].signatureSaved;
    }

    function getPortfolioLinksForText() {
      return portfolioItems
        .filter(item => item.href)
        .map(item => `- ${item.title || item.href}: ${item.href}`)
        .join('\n');
    }

    function generateSummaryText() {
      const client = document.getElementById('client').value.trim() || (currentLang === 'ar' ? 'Ø¹Ù…ÙŠÙ„' : 'Valued Customer');
      const service = document.getElementById('serviceType').selectedOptions[0]?.textContent || '-';
      const total = document.getElementById('totalAmount').textContent;
      const duration = document.getElementById('duration').value || '-';
      const startDate = document.getElementById('startDate').value || '-';
      const scope = document.getElementById('scope').value.trim();
      const ref = document.getElementById('offerRef').value.trim() || '-';
      const links = getPortfolioLinksForText();

      if (currentLang === 'ar') {
        return `Ø¹Ø±Ø¶ OMO G\n\n` +
          `Ø§Ù„Ø¹Ù…ÙŠÙ„: ${client}\n` +
          `Ø±Ù‚Ù… Ø§Ù„Ø¹Ø±Ø¶: ${ref}\n` +
          `Ø§Ù„Ø®Ø¯Ù…Ø©: ${service}\n` +
          `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total}\n` +
          `Ø§Ù„Ù…Ø¯Ø©: ${duration}\n` +
          `ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡: ${startDate}\n\n` +
          `Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„:\n${scope}\n\n` +
          (links ? `Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø¹Ù…Ø§Ù„:\n${links}\n\n` : '') +
          `Ø§Ù„Ù‡Ø§ØªÙ: ${document.getElementById('companyPhone').value.trim()}\n` +
          `Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${document.getElementById('companyWebsite').value.trim()}`;
      }

      return `OMO G Offer\n\n` +
        `Client: ${client}\n` +
        `Offer Ref: ${ref}\n` +
        `Service: ${service}\n` +
        `Total: ${total}\n` +
        `Duration: ${duration}\n` +
        `Start Date: ${startDate}\n\n` +
        `Scope:\n${scope}\n\n` +
        (links ? `Portfolio Links:\n${links}\n\n` : '') +
        `Phone: ${document.getElementById('companyPhone').value.trim()}\n` +
        `Website: ${document.getElementById('companyWebsite').value.trim()}`;
    }

    function shareWhatsApp() {
      const text = generateSummaryText();
      window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }

    function copyToClipboard() {
      navigator.clipboard.writeText(generateSummaryText()).then(() => {
        alert(i18n[currentLang].copied);
      });
    }

    function bindLiveUpdates() {
      ['companyNameEn', 'companyNameAr', 'companyTaglineEn', 'companyTaglineAr', 'offerBadgeEn', 'offerBadgeAr', 'companyPhone', 'companyEmail', 'companyWebsite', 'companyAddressEn', 'companyAddressAr', 'companySocial'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener('input', refreshTexts);
      });
    }

    function init() {
      document.getElementById('date').valueAsDate = new Date();
      document.getElementById('signatureDate').valueAsDate = new Date();
      addLineItem();
      bindLiveUpdates();
      resizeCanvas();

      signatureCanvas.addEventListener('mousedown', startDraw);
      signatureCanvas.addEventListener('mousemove', draw);
      window.addEventListener('mouseup', endDraw);

      signatureCanvas.addEventListener('touchstart', startDraw, { passive: false });
      signatureCanvas.addEventListener('touchmove', draw, { passive: false });
      signatureCanvas.addEventListener('touchend', endDraw);

      window.addEventListener('resize', resizeCanvas);
      translateUi();
      calculateTotal();
    }

    init();
  </script>
</body>
</html>
